CUR_MEAS = [% d = 10%
            [1749 1753 1758 1735 1767 1774 1774 1777 1777 1780 1784 1782 1783 1786 1786 1788 1785 1788 1788 1786 1788 1787 1786 1783 1785 1786 1786 1784 1783 1783 1783 1782 1784 1782 1782 1780 1781 1777 1778 1778 1777 1776 1775 1776 1774 1774 1775 1774 1774 1774 1780 1774 1774 1772 1773 1773 1771]
            [1686 1689 1694 1699 1700 1716 1709 1711 1691 1716 1719 1719 1722 1723 1723 1723 1782 1723 1723 1719 1723 1723 1725 1724 1723 1718 1723 1724 1723 1723 1723 1726 1697 1723 1723 1723 1723 1723 1723 1723 1723 1723 1723 1723 1722 1722 1723 1721 1719 1721 1722 1721 1761 1711 1720 1719 1719]
            [1680 1687 1690 1695 1698 1699 1705 1708 1713 1711 1712 1715 1715 1715 1716 1719 1719 1719 1720 1719 1719 1719 1721 1719 1719 1721 1721 1719 1721 1722 1786 1719 1723 1719 1703 1719 1723 1720 1766 1719 1716 1717 1719 1718 1717 1718 1716 1719 1716 1715 1716 1723 1726 1731 1734 1738 1740]
            [1683 1687 1695 1698 1701 1706 1710 1710 1711 1713 1715 1716 1719 1720 1720 1721 1722 1722 1731 1722 1723 1723 1723 1726 1723 1723 1723 1723 1723 1723 1723 1723 1722 1721 1722 1721 1722 1721 1719 1716 1721 1724 1729 1735 1737 1740 1742 1745 1747 1748 1749 1750 1749 1750 1750 1750 1751]
            [1890 1912 1898 1902 1902 1905 1908 1907 1906 1909 1909 1910 1910 1928 1906 1908 1906 1904 1864 1906 1902 1902 1902 1901 1902 1900 1897 1897 1896 1894 1894 1891 1890 1888 1896 1898 1900 1903 1903 1905 1906 1906 1910 1908 1906 1909 1908 1909 1908 1906 1905 1904 1902 1903 1903 1904 1901]
            [1910 1916 1923 1928 1928 1930 1932 1932 1936 1930 1930 1928 1979 1929 1928 1926 1925 1924 1922 1920 1913 1917 1915 1916 1913 1911 1903 1909 1907 1915 1920 1925 1928 1928 1930 1932 1930 1879 1930 1930 1928 1928 1928 1925 1926 1924 1922 1920 1919 1917 1917 1916 1913 1913 1913 1910 1908]
            [1687 1698 1703 1710 1712 1719 1723 1723 1723 1723 1723 1725 1725 1726 1725 1725 1726 1726 1724 1724 1724 1746 1724 1723 1724 1726 1737 1747 1750 1753 1756 1759 1760 1672 1760 1761 1761 1773 1761 1761 1761 1780 1761 1761 1761 1760 1758 1758 1758 1760 1761 1774 1778 1785 1788 1789 1792]
            [1670 1683 1687 1620 1697 1698 1699 1700 1705 1707 1708 1711 1711 1711 1703 1711 1712 1711 1710 1725 1715 1712 1713 1723 1729 1726 1729 1735 1738 1740 1742 1742 1745 1744 1747 1747 1749 1748 1749 1748 1748 1749 1748 1747 1749 1752 1757 1825 1769 1790 1774 1774 1775 1776 1780 1778 1779]
            [1677 1688 1696 1699 1703 1708 1709 1710 1711 1712 1713 1713 1715 1713 1713 1713 1714 1713 1715 1714 1715 1724 1732 1735 1767 1742 1745 1747 1833 1743 1748 1749 1748 1748 1749 1748 1775 1747 1743 1747 1749 1757 1767 1773 1775 1777 1778 1778 1780 1782 1782 1780 1780 1780 1778 1780 1779]
            % d = 20%
            [1758 1767 1772 1808 1775 1779 1781 1786 1786 1780 1791 1794 1793 1797 1798 1799 1798 1800 1799 1753 1831 1800 1800 1800 1800 1800 1800 1800 1752 1786 1799 1798 1798 1798 1798 1798 1796 1796 1796 1798 1795 1793 1794 1790 1790 1792 1790 1790 1790 1788 1789 1800 1786 1786 1785 1786 1782]
            [1802 1806 1809 1813 1815 1818 1821 1824 1825 1825 1825 1826 1826 1828 1829 1831 1829 1828 1831 1829 1831 1829 1828 1828 1828 1828 1826 1826 1825 1826 1825 1825 1825 1823 1823 1823 1821 1821 1818 1821 1817 1817 1817 1819 1815 1818 1814 1813 1813 1813 1813 1810 1810 1836 1810 1809 1809]
            [1837 1838 1844 1845 1849 1851 1852 1856 1857 1857 1859 1860 1866 1860 1861 1861 1860 1859 1859 1859 1858 1862 1856 1855 1855 1855 1853 1853 1852 1851 1851 1851 1851 1851 1847 1908 1848 1845 1845 1844 1842 1841 1840 1841 1837 1836 1836 1836 1833 1846 1833 1838 1844 1813 1850 1851 1852]
            [1872 1881 1877 1881 1884 1884 1888 1890 1890 1892 1891 1893 1892 1889 1894 1894 1892 1892 1891 1892 1891 1889 1885 1887 1884 1885 1884 1882 1881 1879 1878 1878 1877 1877 1876 1877 1874 1873 1873 1871 1872 1875 1877 1884 1885 1886 1888 1890 1890 1888 1894 1893 1901 1892 1913 1893 1893]
            [1908 1914 1915 1919 1922 1923 1925 1927 1928 1928 1937 1925 1928 1915 1927 1928 1928 1927 1927 1925 1924 1923 1937 1921 1919 1918 1916 1915 1913 1913 1912 1910 1907 1907 1912 1915 1918 1923 1923 1942 1927 1928 1928 1928 1928 1928 1928 1928 1928 1928 1926 1904 1925 1900 1924 1923 1919]
            [1937 1952 1944 1952 1951 1953 1953 1953 1953 1953 1952 1953 1952 1953 1953 1952 1952 1951 1949 1948 1946 1945 1944 1942 1941 1939 1939 1935 1933 1940 1942 1948 1948 1951 1953 1953 1953 1953 1953 1955 1953 1979 1949 1952 2002 1952 1951 1951 1942 1944 1926 1941 1941 1941 1938 1933 1935]
            [1962 1967 1973 1979 1979 1981 1983 1982 1983 1980 1982 1981 1979 1979 1978 1978 1974 1973 1971 1968 1967 1966 1963 1963 2034 1960 1967 1974 1979 1979 1981 1983 1983 1982 1983 1981 1979 1979 1978 1979 1975 1975 1971 1970 1973 1966 1965 1966 1961 1954 1963 1968 1976 1976 1979 1981 1982]
            [2004 2006 2010 2011 2014 2015 2017 2018 2019 2017 2017 2015 2016 2016 2012 2010 2010 2008 2008 2006 2004 2003 2003 2006 2008 2011 2013 2015 2016 2017 2018 2016 2016 2015 2015 2007 2012 2010 2008 2009 2006 2005 2005 2004 2003 2006 2008 2010 2014 2015 2016 2011 2017 2017 2018 2016 2015]
            [2026 2030 2032 2038 2038 2042 2042 2040 2042 2038 2038 2036 2032 2032 2030 2029 2030 2026 2026 2021 2019 2026 2031 2037 2039 2040 2042 2041 2039 2038 2038 2026 2033 2032 2030 2029 2029 2027 2018 2022 2022 2029 2031 2037 2040 2041 2042 2043 2040 2039 2038 2035 2034 2057 2030 2029 2027]
            % d = 30%
            [1774 1777 1780 1785 1788 1790 1794 1796 1799 1801 1801 1802 1804 1804 1805 1807 1806 1787 1809 1810 1810 1810 1810 1812 1811 1811 1811 1810 1812 1810 1811 1813 1810 1813 1778 1810 1802 1809 1810 1808 1806 1745 1806 1802 1805 1804 1802 1800 1804 1801 1801 1801 1800 1800 1799 1799 1798]
            [1812 1814 1820 1824 1825 1826 1828 1830 1833 1837 1837 1837 1837 1839 1839 1840 1841 1841 1842 1843 1840 1843 1841 1841 1840 1837 1842 1839 1839 1839 1837 1839 1812 1836 1834 1834 1833 1832 1831 1826 1828 1829 1826 1827 1825 1825 1825 1825 1825 1823 1821 1821 1820 1818 1814 1817 1817]
            [1849 1851 1853 1857 1860 1864 1864 1866 1867 1869 1869 1872 1873 1871 1872 1874 1875 1874 1873 1876 1869 1872 1872 1869 1870 1870 1860 1867 1865 1866 1864 1864 1863 1861 1862 1861 1860 1869 1857 1856 1853 1853 1852 1853 1851 1851 1850 1849 1849 1853 1847 1851 1856 1859 1861 1864 1865]
            [1887 1892 1894 1896 1901 1884 1902 1908 1907 1904 1907 1908 1912 1908 1910 1904 1917 1907 1909 1908 1904 1904 1904 1904 1902 1902 1902 1901 1900 1898 1897 1896 1896 1894 1891 1891 1888 1922 1888 1885 1885 1890 1896 1896 1900 1902 1902 1905 1905 1906 1907 1910 1910 1909 1908 1904 1902]
            [1922 1927 1931 1932 1933 1933 1936 1940 1935 1942 1943 1942 1941 1942 1942 1941 1942 1941 1938 1939 1936 1936 1935 1932 1932 1932 1966 1928 1928 1928 1927 1925 1923 1924 1927 1928 1932 1933 1938 1939 1939 1940 1941 1944 1981 1943 1942 1941 1944 1943 1940 1939 1938 1940 1938 1935 1933]
            [1948 1953 1958 1965 1963 1968 1971 1969 1974 1973 1974 1969 1973 1968 1961 1966 1965 1965 1962 1961 1959 1958 1957 1953 1953 1953 1951 1951 1946 1952 1957 1962 1965 1967 1968 1971 1974 1972 1971 1971 1971 1970 1967 1952 1966 1965 1962 1962 1960 1955 1953 1953 1953 1952 1959 1949 1948]
            [1979 1983 1989 1986 1995 1997 1999 2000 2002 2001 2000 1991 1997 1995 1994 1993 1991 1991 1953 1984 1983 1981 1979 1979 1925 1978 1983 1976 1992 1995 1999 2003 2007 2000 1999 2000 1997 1997 1994 2054 1992 1990 1990 1987 1984 1983 1981 1979 1979 1977 1979 1985 1990 1993 1996 1997 199]
            [2022 2025 2027 2028 2030 2033 2031 2031 2022 2031 2034 2032 2031 2030 2030 2030 2029 2027 2022 2022 2021 2019 2018 2022 2026 2028 2029 2030 2030 2030 2031 2031 2031 2030 2031 2031 2034 2029 2030 2026 2022 2026 2020 2019 2017 2021 2028 2029 2030 2030 2030 2034 2054 2031 2027 2030 2032]
            [2042 2050 2055 2058 2060 2064 2064 2063 2064 2061 2061 2058 2058 2055 2054 2054 2030 2048 2046 2042 2044 2051 2055 2056 2061 2063 2064 2064 2063 2061 2059 2057 2056 2055 2055 2052 2051 2052 2045 2043 2044 2054 2055 2058 2061 2061 2064 2061 2060 2059 2059 2046 2055 2055 2054 2050 2052]
            % d = 40%
            [1782 1787 1791 1793 1800 1737 1801 1806 1806 1810 1810 1811 1813 1813 1815 1815 1815 1814 1817 1818 1818 1817 1817 1817 1817 1817 1804 1815 1817 1817 1815 1817 1817 1817 1790 1814 1816 1817 1815 1818 1817 1815 1816 1815 1814 1814 1814 1814 1813 1813 1812 1813 1812 1810 1810 1810 1809]
            [1823 1825 1829 1831 1839 1837 1841 1844 1844 1849 1847 1848 1851 1851 1851 1851 1851 1851 1851 1861 1851 1851 1852 1851 1853 1851 1841 1851 1851 1851 1851 1850 1850 1849 1850 1849 1848 1847 1846 1844 1842 1841 1844 1842 1841 1839 1838 1837 1837 1836 1835 1832 1830 1831 1829 1831 1827]
            [1875 1866 1872 1874 1874 1877 1881 1881 1882 1900 1884 1888 1888 1888 1887 1888 1889 1888 1889 1888 1888 1890 1887 1884 1885 1885 1887 1882 1884 1881 1858 1881 1878 1877 1878 1877 1879 1874 1870 1874 1902 1869 1868 1866 1868 1865 1852 1864 1863 1862 1864 1865 1865 1876 1877 1877 1879]
            [1902 1903 1907 1911 1912 1914 1916 1916 1919 1916 1916 1920 1923 1952 1922 1923 1924 1924 1928 1920 1923 1920 1920 2003 1916 1915 1914 1916 1912 1912 1850 1909 1905 1906 1906 1904 1896 1902 1902 1901 1910 1903 1906 1910 1914 1915 1915 1918 1917 1919 1922 1920 1923 1925 1923 1924 1924]
            [1935 1937 1942 1944 1969 1942 1951 1951 1953 1949 1953 1953 1954 1980 1953 1953 1953 1953 1953 1952 1951 1949 1951 1948 2007 1943 1941 1943 1939 1938 1937 1936 1936 1932 1936 1941 1943 1949 1948 1953 1951 1952 1952 1953 1956 1954 1953 1953 1953 1953 1954 1952 1951 1951 1949 1949 1948]
            [1960 1969 1966 1978 1978 1979 1980 1991 1983 1983 1983 1983 1981 1980 1979 1981 1979 1976 1971 1971 1968 1967 1968 1966 1966 1966 1955 1959 1963 1963 1971 1974 1978 1989 1979 1980 1980 1982 1983 1989 1980 1979 1981 1979 1978 1977 1975 1975 1970 1968 1967 1966 1964 1964 1962 1963 1957]
            [1988 1996 2003 2004 2007 2008 2015 2009 2010 2026 2011 2011 2007 2007 2007 2004 2004 2003 2003 2000 1997 1997 1994 1992 1989 1987 1997 2003 2004 2006 2011 2010 2009 2013 2017 2010 2010 2007 2007 2004 2005 2004 2003 1999 1996 1997 1996 1992 1991 2034 1991 1998 2004 2004 2006 2009 2011]
            [2034 2031 2044 2045 2045 2046 2047 2050 2048 2050 2047 2049 2048 2046 2046 2044 2042 2042 2042 2041 2038 2034 2031 2037 2042 2082 2082 2046 2049 2050 2048 2046 2047 2049 2046 2051 2045 2038 2043 2042 2042 2039 2037 2035 2031 2035 2041 2042 2044 2045 2048 2051 2047 2047 2048 2024 2048]
            [2055 2061 2013 2082 2070 2098 2074 2072 2073 2072 2072 2069 2069 2068 2066 2063 2062 2059 2057 2055 2055 2065 2066 2068 2071 2073 2075 2074 2073 2073 2072 2070 2068 2067 2066 2063 2062 2060 2057 2055 2055 2063 2067 2069 2072 2072 2074 2073 2074 2072 2072 2070 2069 2066 2064 2064 2061]
            % d = 50%
            [1794 1800 1802 1806 1808 1812 1813 1817 1817 1821 1821 1823 1823 1825 1825 1825 1825 1825 1825 1825 1827 1887 1825 1824 1826 1826 1825 1825 1825 1825 1790 1909 1825 1825 1825 1825 1825 1826 1826 1825 1825 1825 1825 1825 1825 1774 1825 1825 1825 1825 1825 1824 1825 1824 1824 1823 1823]
            [1834 1837 1841 1844 1849 1850 1851 1852 1853 1856 1856 1858 1860 1860 1859 1851 1859 1861 1814 1861 1861 1861 1861 1861 1856 1861 1860 1860 1862 1861 1860 1862 1860 1859 1857 1860 1858 1856 1855 1855 1823 1852 1853 1851 1851 1851 1850 1850 1849 1847 1849 1845 1833 1842 1842 1840 1841]
            [1875 1877 1882 1884 1887 1889 1892 1894 1894 1895 1898 1900 1899 1901 1904 1900 1900 1900 1863 1899 1901 1900 1900 1899 1900 1900 1901 1898 1899 1896 1893 1893 1891 1894 1891 1889 1889 1886 1887 1884 1882 1881 1881 1880 1878 1877 1888 1877 1877 1874 1875 1879 1882 1886 1888 1890 1891]
            [1964 1916 1920 1923 1927 1927 1928 1929 1928 1930 1932 1937 1946 1932 1932 1932 1942 1932 1931 1932 1932 1960 1929 1928 1928 1921 1928 1928 1926 1924 1923 1920 1919 1919 1917 1914 1917 1909 1913 1911 1924 1915 1920 1918 1924 1926 1928 1928 1930 1929 1931 1930 1930 1932 1932 1932 1932]
            [1949 2003 1953 1955 1960 1959 1964 1963 1965 1966 1966 2030 1967 1994 2030 1966 1965 1966 1964 1965 1963 1963 1958 1957 1955 1955 1955 1953 1953 1953 1952 1951 1948 1891 1952 1953 1963 1957 1959 1961 1962 1962 1964 1965 1965 1965 1964 1966 1965 1917 1964 1963 1963 1963 1962 1961 1958]
            [1979 1979 1979 1986 1989 1991 1992 1993 1994 1994 1992 1992 1991 1991 1991 1990 1989 1999 1984 1981 1980 1979 1979 1977 1976 1973 1973 1970 1968 1974 1979 1984 1987 1988 1993 1991 1993 1992 1991 1992 1992 1992 1989 1989 1989 1986 1987 1981 1979 1979 1979 1978 1977 1974 1973 1970 1961]
            [2004 2011 2018 2019 2022 2024 2026 2029 2027 2026 2026 2025 2022 2022 2021 2019 2018 2017 2030 2015 2010 2008 2007 2004 2004 2004 1976 2017 2019 2019 2024 2025 2027 2021 2026 2026 2026 2025 2024 2022 2019 2018 2017 2017 2015 2011 2010 2006 2030 2004 2005 2012 2017 2041 2021 2022 2025]
            [2042 2046 2054 2055 2043 2058 2060 2061 2062 2058 2060 2134 2057 2056 2055 2053 2053 2050 2038 2045 2043 2040 2038 2045 2051 2054 2055 2057 2060 2061 2058 2059 2059 2058 2056 2056 2055 2054 2051 2050 2046 2047 2044 2044 2040 2046 2053 2054 2058 2058 2030 2061 2060 2061 2058 2059 2058]
            [2068 2077 2081 2082 2057 2086 2088 2086 2088 2097 2085 2085 2104 2081 2082 2080 2077 2074 2072 2071 2069 2141 2081 2083 2086 2055 2088 2088 2086 2086 2086 2083 2085 2080 2081 2080 2077 2076 2072 2075 2070 2077 2081 2082 2086 2087 2088 2088 2086 2085 2088 2085 2082 2081 2080 2081 2076]
            % d = 60%
            [1805 1853 1867 1817 1820 1823 1825 1826 1828 1830 1831 1831 1831 1836 1833 1843 1836 1836 1834 1839 1837 1838 1780 1838 1840 1838 1838 1837 1837 1837 1837 1837 1837 1836 1837 1835 1836 1834 1834 1837 1833 1833 1833 1834 1833 1833 1835 1833 1834 1833 1833 1839 1831 1830 1833 1837 1830]
            [1846 1849 1852 1857 1859 1862 1863 1865 1865 1877 1869 1851 1870 1869 1874 1873 1873 1873 1873 1876 1873 1874 1873 1881 1875 1884 1873 1872 1870 1834 1869 1869 1869 1869 1869 1869 1868 1868 1867 1868 1866 1866 1864 1864 1864 1863 1874 1861 1860 1858 1861 1853 1855 1855 1853 1855 1855]
            [1885 1887 1890 1897 1898 1900 1902 1879 1903 1907 1904 1907 1906 1904 1906 1909 1908 1908 1907 1905 1908 1906 1906 1907 1906 1907 1902 1904 1903 1903 1903 1903 1902 1902 1901 1900 1900 1898 1896 1895 1894 1893 1892 1891 1890 1888 1888 1885 1884 1884 1884 1889 1893 1895 1900 1902 1851]
            [1923 1927 1929 1933 1935 1938 1940 1940 1941 1943 1943 1944 1943 1943 1943 1944 1942 1940 1942 1942 1943 1940 1943 1940 1940 1939 1936 1939 1935 1933 1933 1991 1930 1930 1928 1928 1927 1927 1924 1923 1912 1927 1930 1933 1932 1936 1939 1940 1940 1954 1911 2003 1943 1944 1944 1944 1943]
            [1958 1961 1965 1969 1967 1971 1992 1968 1975 1975 1974 1976 1977 1976 1976 1976 1975 1975 1974 1973 1973 1971 1969 1967 1967 1967 1967 1964 1965 1963 1961 1958 1955 1957 1956 1960 1966 1968 1970 1971 1975 1974 1973 1977 1975 1976 1975 1976 1975 1976 1974 1974 1973 1969 1971 1968 1968]
            [1979 1983 1992 2058 1981 1999 2003 1987 2003 2017 2000 2002 2002 2003 1999 1999 1995 1995 1993 1992 1991 1989 1987 1987 1984 1981 1980 1980 1979 1981 1983 1989 1991 1991 1992 1982 1992 1994 1991 1991 1991 1991 1991 1991 1991 2003 1991 1990 1990 1987 1984 1984 1981 1980 1979 1979 1978]
            [2019 2029 2027 2030 2034 2034 2030 2038 2035 2035 2034 2034 2034 2033 2030 2030 2030 1963 2028 2026 2022 2021 2019 2022 2016 2016 2027 2030 2030 2031 2034 2034 2035 2039 2037 2035 2035 2034 2034 2030 2030 2030 2022 2030 2026 2024 2022 2019 2019 2017 2017 2026 2029 2030 2034 2034 2035]
            [2053 2055 2064 2064 2066 2067 2069 2067 2069 2069 2068 2061 2066 2065 2063 2060 2060 2058 2055 2055 2054 2051 2098 2055 2058 2058 2066 2069 2070 2068 2061 2070 2067 2069 2067 2066 2066 2063 2063 2058 2057 2051 2054 2055 2050 2055 2059 2061 2048 2066 2055 2068 2068 2067 2068 2062 2066]
            [2077 2082 2086 2089 2093 2094 2093 2093 2093 2093 2093 2091 2090 2086 2086 2085 2082 2081 2080 2078 2077 2081 2086 2090 2093 2093 2094 2094 2095 2109 2096 2091 2090 2086 2086 2083 2082 2076 2082 2077 2080 2086 2106 2090 2093 2095 2096 2125 2094 2093 2091 2090 2089 2086 2084 2083 2082]
            % d = 70%
            [1817 1821 1827 1827 1828 1840 1834 1837 1838 1839 1842 1842 1843 1846 1846 1846 1846 1844 1847 1847 1847 1846 1848 1847 1845 1866 1845 1825 1844 1844 1845 1847 1845 1845 1846 1844 1844 1843 1844 1842 1851 1843 1842 1841 1847 1839 1842 1841 1840 1839 1841 1840 1839 1816 1838 1839 1838]
            [1857 1860 1863 1866 1869 1872 1874 1877 1865 1877 1878 1877 1877 1879 1880 1880 1879 1879 1814 1879 1873 1879 1881 1881 1878 1885 1879 1878 1881 1877 1877 1877 1877 1877 1877 1877 1876 1876 1874 1876 1874 1876 1874 1875 1864 1873 1872 1873 1871 1872 1869 1868 1868 1867 1865 1864 1863]
            [1899 1900 1903 1904 1909 1912 1912 1914 1915 1916 1914 1915 1917 1918 1874 1917 1864 1916 1915 1919 1916 1916 1916 1916 1910 1915 1914 1915 1914 1913 1913 1913 1911 1910 1908 1909 1908 1906 1907 1907 1836 1902 1898 1851 1901 1902 1901 1893 1897 1895 1900 1901 1903 1907 1907 1913 1914]
            [1935 1939 1941 1943 1946 1948 1950 1952 1952 1953 1953 1953 1954 1953 1953 1954 1953 1953 1953 1952 1952 1952 1953 1951 1952 1943 1949 1948 1948 1944 1944 1943 1942 1940 1940 1937 1936 1936 1933 1934 1935 1940 1943 1944 1946 1949 1951 1937 1953 1952 1953 1953 1954 1953 1948 1968 1953]
            [1967 1971 1971 1975 1978 1917 1979 1981 1980 1981 1981 1981 1981 1981 1983 1980 1913 1979 1979 1979 1983 1979 1979 1976 1976 1976 1974 1974 1971 1971 1968 1967 1968 1965 1967 1970 1974 1977 1970 1979 1981 1979 1980 1980 1981 1982 2006 2002 1980 1979 1980 1979 1979 1978 1979 1979 1978]
            [1991 1999 2002 2002 2004 2004 2006 2005 2008 2005 2005 2004 2005 2006 2005 2004 2004 2003 2004 2076 2003 2000 1999 1999 1995 1994 1994 1991 1989 1994 1999 2000 2003 2004 2004 1995 2004 2004 2004 1999 2005 2005 2004 2004 2004 2004 2003 2003 2002 2003 2000 1997 1997 1994 1996 1993 1991]
            [2025 2030 2030 2032 2034 2034 2038 2037 2035 2038 2038 2038 2037 2035 2038 2034 2034 2033 2032 2032 2030 2029 2028 2027 2027 2024 2030 2030 2032 2034 2034 2035 2037 2036 2034 2038 2050 2035 2034 2034 2009 2029 2032 2032 2030 2030 2030 2029 2026 2025 2026 2029 2030 2030 2034 2034 2035]
            [2056 2061 2064 2067 2068 2066 2069 2070 2070 2070 2068 2067 2067 2066 2068 2066 2064 2063 2061 2061 2058 2056 2057 2061 2066 2067 2066 2067 2068 2068 2068 2068 2068 2068 2068 2067 2066 2064 2066 2038 2064 2061 2058 2056 2055 2059 2063 2064 2067 2068 2067 2068 2068 2068 2069 2069 2067]
            [2083 2090 2093 2097 2098 2099 2102 2101 2100 2097 2097 2096 2096 2094 2091 2090 2090 2086 2085 2082 2082 2089 2093 2095 2099 2097 2098 2099 2099 2099 2096 2094 2094 2093 2093 2088 2090 2086 2082 2083 2083 2090 2093 2097 2098 2098 2097 2099 2097 2098 2096 2094 2093 2092 2091 2086 2086]
            % d = 80%
            [1828 1831 1837 1839 1844 1845 1849 1851 1851 1853 1853 1853 1853 1838 1858 1855 1856 1857 1857 1857 1857 1859 1858 1857 1858 1858 1854 1857 1857 1855 1857 1857 1864 1861 1853 1853 1857 1855 1852 1852 1782 1853 1853 1852 1853 1853 1852 1851 1851 1851 1850 1851 1851 1850 1851 1849 1849]
            [1868 1875 1876 1878 1881 1882 1884 1887 1891 1890 1889 1890 1892 1890 1893 1893 1893 1893 1894 1894 1893 1892 1892 1892 1895 1897 1891 1890 1888 1890 1889 1889 1888 1886 1888 1887 1885 1885 1878 1885 1884 1884 1882 1881 1881 1881 1877 1880 1879 1878 1879 1877 1878 1877 1877 1877 1877]
            [1902 1907 1932 1926 1915 1916 1918 1919 1922 1920 1924 1924 1925 1924 1925 1924 1925 1926 1925 1924 1923 1923 1923 1888 1920 1919 1920 1920 1916 1920 1916 1916 1916 1915 1916 1915 1914 1914 1915 1912 1911 1909 1910 1908 1908 1906 1904 1903 1902 1903 1902 1906 1910 1913 1916 1917 1920]
            [1936 1940 1944 1948 1951 1952 1953 1953 1954 1955 1949 1957 1955 1954 1954 1954 1955 1954 1953 1953 1953 1963 1953 1952 1952 1951 1951 1950 1948 1944 1945 1944 1944 1943 1943 1987 1908 1939 1936 1946 1938 1940 1924 1946 1949 1952 1953 1953 1954 1953 1955 1954 1955 1955 1954 1955 1954]
            [1976 1974 1975 1979 1979 1979 1980 1983 1979 1982 1983 1983 1983 1983 1981 1981 1986 1980 1980 1981 1979 1979 1979 1979 1978 1977 1976 1975 1974 1974 1971 1971 1968 1967 1971 1975 1975 1979 1979 1981 1979 1982 1983 1983 1983 1984 1983 1984 1981 1982 1981 1980 1983 1979 1979 1992 1966]
            [1995 1999 2009 2003 2007 2007 2007 2007 1992 2011 2007 2007 2007 2005 2007 2011 2005 2004 2004 2004 2004 2002 2002 2000 1999 1997 1996 1994 1992 1997 2002 2004 2004 1966 2006 2007 2007 2007 2007 2009 2009 2006 2006 2006 2006 2008 2004 2004 2003 2002 2004 2002 1999 1999 1997 1998 1994]
            [2022 2025 2027 2030 2012 2030 2031 2030 2032 2032 2033 2033 2032 2033 2030 2030 2030 2030 2042 2026 2024 2024 2024 2026 2020 2019 2022 2026 2030 2030 2030 2030 2034 2032 2032 2031 2032 2031 2030 2030 2030 2030 2029 2030 2028 2026 2026 2022 2019 2021 2022 2026 2028 2030 2032 2030 2030]
            [2053 2055 2056 2057 2062 2059 2060 2060 2061 2063 2059 2059 2060 2060 2072 2055 2055 2055 2055 2055 2053 2050 2050 2118 2055 2057 2058 2059 2060 2061 2062 2059 2060 2058 2059 2059 2057 2056 2055 2055 2055 2054 2055 2051 2050 2055 2056 2058 2059 2059 2062 2058 2060 2060 2036 2061 2058]
            [2074 2081 2081 2088 2088 2088 2089 2090 2089 2086 2106 2084 2083 2082 2081 2081 2081 2077 2073 2030 2071 2081 2041 2083 2088 2090 2089 2090 2086 2088 2086 2086 2086 2082 2081 2081 2080 2078 2077 2074 2074 2080 2082 2086 2089 2086 2089 2090 2078 2090 2085 2086 2083 2082 2083 2079 2079]
            % d = 90%
            [1841 1843 1852 1851 1853 1855 1857 1863 1861 1862 1864 1864 1865 1866 1865 1865 1867 1866 1868 1866 1866 1866 1866 1866 1865 1865 1912 1882 1860 1865 1865 1865 1865 1865 1865 1865 1864 1864 1862 1863 1863 1862 1861 1860 1877 1859 1858 1857 1857 1851 1856 1856 1831 1856 1855 1855 1855]
            [1874 1877 1881 1896 1886 1871 1891 1893 1893 1893 1893 1898 1897 1897 1894 1897 1897 1896 1898 1897 1896 1898 1897 1895 1965 1896 1895 1895 1894 1889 1892 1893 1892 1892 1892 1890 1891 1889 1888 1888 1888 1900 1891 1887 1886 1887 1884 1882 1882 1883 1875 1881 1881 1877 1879 1879 1878]
            [1909 1912 1915 1916 1917 1921 1853 1924 1925 1925 1926 1930 1927 1927 1927 1928 1928 1927 1927 1904 1927 1926 1926 1925 1924 1920 1914 1922 1920 1920 1919 1919 1917 1916 1916 1916 1916 1914 1915 1915 1914 1977 1911 1911 1910 1911 1910 1908 1907 1905 1907 1910 1915 1952 1919 1919 1923]
            [1935 1936 1940 1942 1943 1946 1949 1949 1950 1948 1948 1951 2018 1973 1951 1949 1949 1949 1943 1948 1922 1967 1948 1944 1946 1943 1919 1941 1941 1940 1940 1940 1939 1938 1939 1936 1936 1935 1932 1933 1931 1937 1939 1941 1942 2017 1940 1948 1949 1949 1951 1951 1951 1952 1951 1949 1951]
            [1961 1963 1967 1970 1969 1971 1961 1975 1973 1979 1976 1974 1975 1975 1974 1973 1975 1971 1971 1965 1969 1961 1967 1967 1966 1965 1965 1963 1964 1961 1961 1961 1961 1957 1962 1966 1967 1970 1971 1971 1973 1971 1976 1975 1974 1973 1974 1974 1973 1971 1971 1968 1971 1967 1967 1967 1967]
            [1975 1979 1983 1986 1987 1990 1991 1996 1991 1991 2003 1984 1989 1989 1986 1987 1984 1983 1983 1980 1979 1979 1979 1979 1979 1975 1975 1973 1971 1979 1980 1984 1987 1987 1995 1991 1991 1989 1989 1990 1987 1987 1987 1984 1986 1983 1983 1979 1980 1979 1979 1979 1979 1976 1977 1975 1974]
            [2002 2003 1980 2006 2005 2009 2008 2009 2008 2008 2007 2007 2008 2008 2006 2013 2005 2005 2004 2004 2004 2003 1999 1960 1999 1999 2025 2004 2004 2007 2007 2007 2007 2008 2012 2008 2007 2007 1963 2007 2003 2005 2005 2004 2004 2003 2001 2003 2000 1999 1999 2003 2004 2004 2006 2007 2008]
            [1999 1987 2026 2028 2029 2030 2030 2029 2029 2030 2028 2030 2027 2027 2027 2024 2022 2021 2021 2018 2018 2017 2017 2027 2026 2028 2029 2030 2029 2030 2030 2030 2030 2026 2029 2025 2025 2024 2022 2021 2020 2019 2018 2017 2014 2019 2022 2024 2027 2030 2029 2030 2030 2030 2029 2028 2027]
            [2034 2038 2042 2046 2046 2047 2047 2047 2048 2046 2044 2044 2042 2044 2042 2042 2096 2034 2034 2034 2035 2040 2042 2044 2046 2046 2048 2046 2046 2028 2044 2043 2042 2041 2041 2040 2038 2038 2034 2031 2035 2042 2042 2045 2047 2046 2047 2046 2078 2046 2046 2042 2041 2041 2042 2038 2035]];

CUR_MEAN = mean(CUR_MEAS,2);
% 200 is the gain of the INA241A5
% 75 * 10^(-3) is the value of the current sensing resistor
CUR_VAL = CUR_MEAN(:,1) * 10^(-3) / 200 / (75 * 10^(-3));

S_ANGLE_V = zeros(9,9);
S_TRANS_V = zeros(9,9);
S_CURRENT = zeros(9,9);
S_POWER_C = zeros(9,9);
S_ANGLE_EFF = zeros(9,9);
S_TRANS_EFF = zeros(9,9);

% looping over duty cycle
for d = 1:9
    % initialize frequency array index
    f = 1;
    
    % looping over frequency
    for freq = 10:5:50
        % read in the Vicon .csv file
        M = readtable('C:\Users\alexn\Documents\senior_thesis\actuator4\actuator4 f'+string(freq)+' d'+string(d)+'.csv', 'ReadVariableNames', false);
        numRows = height(M) + 2;
        M = readmatrix('C:\Users\alexn\Documents\senior_thesis\actuator4\actuator4 f'+string(freq)+' d'+string(d)+'.csv', 'Range', 'A6:H'+string(numRows));

        % unit processing
        M(:,2) = M(:,1) / 120;
        M(:,3) = M(:,3) * 180 / pi;
        M(:,4) = M(:,4) * 180 / pi;
        M(:,5) = M(:,5) * 180 / pi;

        % smoothing
        S = smoothdata(M,"gaussian",120); % window size of 120 to match frame/sampling rate

        % find valid initial and final indices
        firstValidIndex = find(~isnan(M(:,5)), 1);
        lastValidIndex = find(~isnan(M(:,5)), 1, 'last');

        % calculate angular velocity
        S_ANGLE_V(d,f) = (S(lastValidIndex, 5) - S(firstValidIndex, 5)) / 15;
        
        % calculate magnitude of translational velocity
        v_x = (S(lastValidIndex, 6) - S(firstValidIndex, 6)) / 15;
        v_y = (S(lastValidIndex, 7) - S(firstValidIndex, 7)) / 15;
        S_TRANS_V(d,f) = sqrt(v_x^2 + v_y^2);

        % calculate current consumption and power
        S_CURRENT(d,f) = CUR_VAL((d-1)*9 + f, 1);
        S_POWER_C(d,f) = S_CURRENT(d,f) * 7.4; % 7.4 is the total input voltage to eViper


        S_ANGLE_EFF(d,f) = abs(S_ANGLE_V(d,f)) / S_POWER_C(d,f);
        S_TRANS_EFF(d,f) = S_TRANS_V(d,f) / S_POWER_C(d,f);

        % increment frequency array indexing
        f = f + 1;
    end
end

%%
% initialize frames to measure average velocities from
init_start = 1;
init_end = 50;
final_start = 2100;
final_end = 2150;

% import for all docs
% num = 2;
% M = readtable('C:\Users\alexn\Documents\senior_thesis\3_06_2024\3_06_2024 actuator4 '+string(num)+'.csv', 'ReadVariableNames', false);
% numRows = height(M) + 2;
% M = readmatrix('C:\Users\alexn\Documents\senior_thesis\3_06_2024\3_06_2024 actuator4 '+string(num)+'.csv', 'Range', 'A6:H'+string(numRows));

freq = 45;
duty = 9;
M = readtable('C:\Users\alexn\Documents\senior_thesis\actuator4\actuator4 f'+string(freq)+' d'+string(duty)+'.csv', 'ReadVariableNames', false);
numRows = height(M) + 2;
M = readmatrix('C:\Users\alexn\Documents\senior_thesis\actuator4\actuator4 f'+string(freq)+' d'+string(duty)+'.csv', 'Range', 'A6:H'+string(numRows));

% unit processing
M(:,2) = M(:,1) / 120;
M(:,3) = M(:,3) * 180 / pi;
M(:,4) = M(:,4) * 180 / pi;
M(:,5) = M(:,5) * 180 / pi;

% smoothing
S = smoothdata(M,"gaussian",120); % window size of 120 to match frame/sampling rate

% unsmoothed
close all;
figure(1);
subplot(2, 2, 1);
% plot(M(:,1), M(:,3));
% hold on;
% plot(M(:,1), M(:,4));
plot(M(:,1), M(:,5));
% legend({'angular disp. in X dir. (degree)', 'angular disp. in Y dir. (degree)', 'angular disp. in Z dir. (degree)'}, 'Location', 'east');
legend({'angular pos. in degrees'});
grid minor;
grid on;
hold off;

subplot(2, 2, 3);
plot(M(:,1), M(:,6));
legend({'X pos. (mm)'});
grid minor;
grid on;
hold off;

subplot(2, 2, 4);
plot(M(:,1), M(:,7));
legend({'Y pos. (mm)'});
grid minor;
grid on;
hold off;

sgtitle('actuator 4, frequency '+string(freq)+', duty cycle '+string(duty));

% smoothed
figure(2);
subplot(2, 2, 1);
% plot(M(:,1), M(:,3));
% hold on;
% plot(M(:,1), M(:,4));
plot(S(:,1), S(:,5));
% legend({'angular disp. in X dir. (degree)', 'angular disp. in Y dir. (degree)', 'angular disp. in Z dir. (degree)'}, 'Location', 'east');
legend({'angular pos. in degrees'});
grid minor;
grid on;
hold off;

subplot(2, 2, 3);
plot(S(:,1), S(:,6));
legend({'X pos. (mm)'});
grid minor;
grid on;
hold off;

subplot(2, 2, 4);
plot(S(:,1), S(:,7));
legend({'Y pos. (mm)'});
grid minor;
grid on;
hold off;

sgtitle('smoothed actuator 4, frequency '+string(freq)+', duty cycle '+string(duty));

% smoothed
figure(3);
subplot(2, 2, 1);
% plot(M(:,1), M(:,3));
% hold on;
% plot(M(:,1), M(:,4));
plot(M(:,1), M(:,5));
hold on;
plot(S(:,1), S(:,5));
% legend({'angular disp. in X dir. (degree)', 'angular disp. in Y dir. (degree)', 'angular disp. in Z dir. (degree)'}, 'Location', 'east');
legend({'angular pos. in degrees', 'smoothed angular pos. in degrees'});
grid minor;
grid on;
hold off;

subplot(2, 2, 3);
plot(M(:,1), M(:,6));
hold on;
plot(S(:,1), S(:,6));
legend({'X pos. (mm)', 'smoothed X pos. (mm)'});
grid minor;
grid on;
hold off;

subplot(2, 2, 4);
plot(M(:,1), M(:,7));
hold on;
plot(S(:,1), S(:,7));
legend({'Y pos. (mm)', 'smoothed Y pos. (mm)'});
grid minor;
grid on;
hold off;

sgtitle('smoothed vs unsmoothed actuator 4, frequency '+string(freq)+', duty cycle '+string(duty));

firstValidIndex = find(~isnan(M(:,5)), 1);
lasValidIndex = find(~isnan(M(:,5)), 1, 'last');
%%
% calculate angular velocity
init_angle = mean(M(init_start:init_end,5), "all");
final_angle = mean(M(final_start:final_end,5), "all");
avg_angle_vel = (final_angle - init_angle) / 15;
disp("ANGLE: ");
% disp(init_angle);
% disp(final_angle);
disp(avg_angle_vel);

% calculate x velocity
init_x = mean(M(init_start:init_end,6), "all");
final_x = mean(M(final_start:final_end,6), "all");
avg_x_vel = (final_x - init_x) / 15;
disp("X: ");
% disp(init_x);
% disp(final_x);
disp(avg_x_vel);

% calculate y velocity
init_y = mean(M(init_start:init_end,7), "all");
final_y = mean(M(final_start:final_end,7), "all");
avg_y_vel = (final_y - init_y) / 15;
disp("Y: ");
% disp(init_y);
% disp(final_y);
disp(avg_y_vel);