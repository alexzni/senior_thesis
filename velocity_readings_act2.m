CUR_MEAS = [% d = 10%
            [1749 1754 1761 1772 1776 1774 1813 1786 1787 1790 1792 1792 1794 1818 1791 1792 1791 1791 1790 1791 1789 1790 1790 1788 1786 1787 1786 1786 1785 1786 1783 1783 1782 1782 1778 1783 1779 1780 1778 1777 1778 1776 1775 1774 1774 1775 1774 1774 1774 1774 1774 1774 1772 1771 1785 1772 1770]
            [1786 1794 1801 1804 1810 1813 1814 1760 1818 1818 1821 1821 1761 1837 1821 1821 1818 1820 1817 1816 1814 1814 1818 1813 1813 1813 1813 1812 1812 1816 1809 1808 1806 1805 1805 1804 1802 1805 1802 1749 1800 1800 1800 1825 1798 1825 1798 1796 1798 1796 1795 1793 1795 1794 1791 1790 1789]
            [1679 1686 1696 1699 1706 1708 1711 1714 1715 1719 1719 1719 1721 1719 1723 1719 1719 1739 1721 1721 1719 1720 1719 1719 1719 1719 1719 1719 1719 1706 1716 1716 1732 1718 1715 1715 1711 1716 1715 1735 1715 1715 1712 1713 1713 1712 1713 1713 1712 1715 1719 1723 1731 1736 1741 1748 1749]
            [1680 1687 1695 1700 1706 1709 1712 1714 1716 1716 1716 1719 1719 1718 1720 1719 1719 1721 1721 1716 1719 1719 1718 1719 1718 1716 1722 1719 1722 1716 1715 1718 1714 1715 1715 1714 1656 1715 1714 1714 1690 1727 1732 1736 1742 1747 1749 1749 1747 1766 1749 1753 1751 1751 1751 1750 1750]
            [1676 1667 1694 1699 1705 1709 1709 1715 1712 1713 1715 1731 1719 1715 1715 1723 1715 1715 1718 1715 1716 1715 1715 1715 1715 1713 1713 1713 1715 1713 1711 1711 1712 1712 1723 1727 1735 1739 1747 1748 1748 1749 1749 1751 1749 1750 1753 1749 1751 1749 1749 1749 1753 1749 1749 1748 1748]
            [1919 1923 1932 1925 1928 1930 1932 1933 1933 1933 1934 1933 1932 1928 1932 1932 1930 1928 1928 1928 1928 1925 1928 1924 1922 1922 1920 1916 1920 1919 1924 1928 1928 1932 1932 1932 1932 1936 1936 1935 1932 1933 1935 1932 1931 1931 1930 1929 1928 1928 1930 1925 1920 1923 1924 1920 1919]
            [1679 1688 1697 1700 1776 1710 1703 1713 1713 1716 1716 1715 1719 1715 1715 1716 1716 1719 1716 1725 1716 1716 1716 1715 1715 1719 1796 1732 1732 1742 1747 1748 1749 1749 1749 1750 1749 1750 1750 1749 1749 1787 1749 1749 1748 1749 1747 1749 1749 1746 1749 1758 1767 1774 1775 1777 1782]
            [1971 1978 1981 1984 1988 1990 1988 1991 1987 1987 1984 1986 1987 1981 1979 1979 1979 1978 1975 1973 1971 1968 1968 1977 1979 1984 1987 1987 1990 1989 1945 1987 1987 1986 1983 1981 1979 1979 1979 1978 1975 1973 1971 1970 1967 1968 1979 1987 1987 1987 1989 1987 1980 1989 1986 1982 1984]
            [1699 1702 1707 1710 1709 1715 1712 1715 1715 1713 1713 1713 1716 1710 1695 1714 1715 1715 1723 1729 1735 1739 1741 1745 1747 1748 1749 1748 1748 1774 1749 1748 1748 1748 1748 1749 1747 1748 1753 1757 1772 1774 1777 1778 1778 1779 1779 1809 1783 1782 1780 1778 1780 1782 1780 1777 1778]
            % d = 20%
            [1766 1824 1779 1785 1789 1774 1798 1800 1800 1801 1802 1805 1808 1805 1805 1806 1808 1810 1757 1808 1810 1809 1810 1808 1808 1807 1760 1805 1802 1802 1813 1798 1801 1801 1800 1800 1800 1800 1800 1796 1801 1798 1795 1796 1793 1794 1794 1792 1791 1805 1790 1790 1789 1788 1788 1786 1785]
            [1802 1810 1814 1821 1825 1825 1829 1831 1834 1834 1837 1837 1837 1839 1840 1833 1821 1837 1836 1840 1837 1836 1833 1834 1834 1831 1829 1828 1829 1830 1825 1825 1825 1825 1825 1824 1823 1821 1821 1820 1818 1817 1817 1821 1814 1815 1814 1814 1813 1813 1811 1810 1810 1809 1807 1808 1804]
            [1841 1849 1853 1857 1863 1865 1866 1861 1873 1874 1874 1875 1875 1875 1875 1875 1873 1873 1871 1869 1869 1866 1866 1865 1865 1863 1864 1893 1861 1861 1857 1859 1856 1853 1853 1852 1852 1851 1850 1849 1849 1849 1846 1844 1842 1841 1842 1841 1839 1837 1841 1849 1853 1858 1863 1865 1868]
            [1888 1882 1888 1893 1896 1901 1904 1902 1904 1904 1904 1905 1904 1903 1903 1902 1909 1901 1901 1900 1898 1898 1894 1892 1887 1891 1890 1887 1885 1885 1882 1882 1881 1877 1877 1877 1877 1876 1876 1866 1876 1881 1888 1893 1897 1900 1902 1903 1904 1904 1902 1904 1904 1902 1902 1902 1900]
            [1904 1915 1919 1924 1927 1928 1930 1932 1932 1934 1933 1932 1933 1930 1930 1932 1928 1941 1927 1904 1922 1920 1919 1920 1917 1915 1912 1911 1913 1910 1909 1906 1904 1904 1913 1917 1924 1926 1930 1928 1932 1932 1932 1932 1932 1932 1929 1929 1904 1928 1927 1924 1924 1922 1920 1920 1919]
            [1953 1954 1955 1955 1961 1961 1966 2032 1967 1967 1967 1965 1966 1965 1965 1964 1965 1964 1960 1960 1959 1957 1955 1954 1953 1953 1952 1952 1950 1953 1954 1957 1961 1962 1965 1965 1966 1967 1966 1967 1968 1965 1967 1964 1965 1963 1963 1963 1961 1958 1955 1955 1955 1953 1952 1953 1948]
            [1968 1976 1984 1984 1987 1990 1992 1992 1992 1991 1991 1989 1987 1987 1986 1982 1981 1981 1978 1976 1975 1974 1971 1968 1968 1978 1977 1979 1983 1987 1989 1991 1991 1992 1991 1990 1989 1979 1985 1984 1983 1980 1979 1979 1961 1976 1974 1971 1970 1967 1968 1978 1980 1987 1989 1990 1991]
            [2028 1953 2011 2019 2020 2024 2026 2025 2024 2026 2074 2021 2021 2018 2017 2017 2015 2013 2009 2010 2007 2004 2011 2009 2017 2022 2019 2025 2025 2028 2026 2026 2025 2021 2021 2018 2017 2019 2015 2013 2010 2015 1993 2004 2004 2008 2013 2020 2022 2024 2027 2027 2027 2026 2025 2022 2019]
            [2042 2047 2054 2123 2056 2061 2059 2061 2060 2058 2055 2057 2055 2053 2053 2050 2048 2046 2043 2040 2040 2047 2053 2055 2057 2059 2059 2061 2059 2058 2058 2055 2054 2053 2051 2048 2047 2045 2042 2040 2040 2050 2054 2056 2056 2058 2060 2058 2060 2056 2056 2055 2055 2054 2051 2047 2044]
            % d = 30%
            [1775 1782 1790 1798 1800 1801 1800 1809 1813 1812 1813 1813 1813 1815 1815 1814 1815 1815 1814 1817 1817 1815 1815 1817 1817 1817 1818 1817 1817 1812 1817 1816 1814 1814 1788 1814 1814 1814 1811 1813 1813 1817 1810 1808 1810 1807 1806 1806 1734 1805 1802 1802 1813 1801 1802 1800 1800]
            [1814 1823 1843 1833 1836 1842 1842 1844 1849 1849 1851 1851 1851 1851 1851 1851 1852 1852 1851 1851 1853 1849 1851 1851 1850 1849 1849 1849 1847 1845 1846 1843 1842 1873 1850 1839 1839 1837 1836 1836 1834 1826 1833 1828 1829 1831 1862 1828 1826 1825 1825 1825 1825 1820 1821 1821 1823]
            [1858 1864 1868 1874 1877 1880 1881 1887 1882 1888 1888 1895 1890 1888 1889 1890 1888 1891 1889 1887 1885 1884 1885 1884 1881 1879 1879 1877 1877 1876 1875 1875 1928 1873 1872 1869 1868 1866 1865 1864 1860 1863 1861 1859 1861 1857 1857 1855 1853 1851 1856 1877 1869 1877 1877 1881 1885]
            [1889 1924 1903 1907 1929 1914 1916 1917 1919 1920 1920 1920 1920 1920 1919 1919 1919 1919 1915 1915 1915 1914 1912 1908 1908 1907 1907 1904 1904 1893 1902 1900 1899 1924 1896 1892 1893 1891 1890 1888 1892 1899 1902 1907 1912 1915 1916 1917 1920 1920 1920 1920 1920 1920 1902 1922 1915]
            [1927 1931 1931 1943 1946 1949 1952 1952 1955 1953 1953 1953 1952 1954 1952 1949 1952 1951 1948 1946 1944 1943 1940 1946 1937 1935 1934 1931 1929 1928 1928 1928 1925 1922 1917 1936 1941 1944 1949 1951 1953 1953 1953 1953 1953 1953 1952 1953 1952 1951 1949 1948 1919 1944 1943 1940 1940]
            [1967 1974 1979 1978 1983 1987 1990 1991 1991 1957 1992 1991 1989 1987 1987 1986 1984 1981 1980 1979 1978 1978 2030 1974 1971 1970 1967 1966 1966 1970 1974 1979 1983 1987 1987 1990 1991 1991 1992 1990 1990 1989 1987 1984 1982 1981 1979 1979 1979 1977 1977 1938 1973 1970 1968 1967 1966]
            [1992 2000 2004 2007 2007 2012 2015 2015 2015 2015 2013 2010 2012 2007 2006 2005 2003 2003 1999 1999 1996 1994 1959 1936 1990 1989 1997 2003 2005 2004 2013 2012 2011 2013 2009 2013 2008 2009 2007 2004 1999 2003 2003 1995 1999 1999 1994 1991 1991 1989 1991 1996 2003 2004 1995 2009 2003]
            [2031 2040 2044 2048 2051 2054 2054 2054 2055 2055 2054 2054 2051 2050 2048 2045 2044 2042 2038 2038 2035 2034 2030 2037 2107 2047 2042 2054 2055 2055 2054 2054 2053 2054 2061 2047 2046 2045 2044 2043 2040 2035 2034 2030 2030 2038 2042 2046 2051 2053 2054 2054 2055 2055 2054 2053 2093]
            [2066 2072 2078 2030 2081 2083 2091 2083 2085 2060 2082 2070 2080 2077 2075 2074 2070 2069 2067 2066 2066 2071 2093 2081 2081 2082 2085 2136 2086 2085 2081 2081 2089 2078 2079 2075 2079 2070 2069 2068 2067 2073 2076 2081 2085 2083 2071 2084 2083 2083 2082 2081 2080 2078 2074 2073 2071]
            % d = 40%
            [1788 1796 1800 1804 1811 1813 1816 1831 1821 1822 1825 1825 1825 1825 1825 1825 1825 1825 1879 1825 1825 1871 1826 1825 1826 1827 1826 1827 1825 1825 1826 1825 1825 1825 1825 1826 1825 1825 1825 1825 1825 1825 1825 1825 1825 1825 1825 1822 1822 1821 1821 1744 1817 1816 1814 1814 1814]
            [1827 1837 1842 1848 1850 1853 1855 1857 1860 1862 1861 1863 1864 1864 1864 1863 1864 1864 1865 1864 1864 1829 1864 1865 1863 1862 1863 1864 1863 1862 1860 1859 1856 1859 1856 1856 1853 1853 1853 1851 1851 1850 1847 1848 1897 1847 1844 1844 1841 1841 1841 1838 1838 1837 1837 1836 1834]
            [1868 1877 1881 1885 1888 1892 1895 1900 1897 1900 1900 1901 1902 1902 1901 1901 1901 1902 1901 1897 1900 1900 1897 1898 1897 1895 1894 1892 1890 1890 1889 1887 1887 1882 1885 1882 1881 1877 1877 1877 1877 1876 1876 1873 1873 1873 1870 1889 1869 1863 1866 1877 1879 1887 1888 1892 1895]
            [1904 1912 1916 1922 1925 1928 1928 1928 1932 1933 1932 1932 1932 1932 1932 1932 1930 1929 1932 1928 1928 1928 1927 1928 1923 1915 1920 1927 1919 1914 1914 1912 1912 1914 1910 1908 1905 1902 1903 1902 1903 1911 1916 1920 1925 1928 1929 1889 1928 1930 1932 1932 1931 1932 1932 1930 1932]
            [1941 1950 1953 1956 1961 1963 1966 1967 2027 1967 1967 1968 1967 1966 1966 1965 1966 1964 1962 1960 1958 1941 1956 1953 1953 1952 1951 1949 1967 1944 1943 1941 1940 1938 1983 1953 1955 1961 1963 1964 1965 1964 1968 1966 1967 1967 1967 1967 1965 1964 1962 1962 1962 1958 1955 1955 1953]
            [1979 1983 1991 1987 1997 1999 2002 2003 2003 2003 2003 2003 2003 2003 2002 2001 1997 1997 1995 1992 1991 1991 1987 1936 1983 1980 1987 1979 1978 1983 1932 1993 1996 1999 2003 2003 2004 2003 2004 2005 2004 2037 2001 2000 2002 1996 1995 1994 1993 1989 1988 1987 1983 1981 1980 1979 1978]
            [2013 2017 2022 2022 2028 2030 2031 2032 2034 2033 2034 2031 2029 2030 2028 2029 2028 2026 2022 2004 2019 2017 2015 2013 2013 2013 2019 2025 2028 2017 2030 2031 2093 2034 2034 2034 2032 2031 2030 2030 2029 2028 2026 2024 2021 2019 2017 2015 2015 2008 2013 2018 2026 2028 2032 2032 2032]
            [2050 2055 2059 2030 2064 2066 2067 2068 2068 2068 2068 2067 2067 2070 2062 2059 2058 2058 2055 2055 2051 2050 2050 2055 2060 2063 2067 2069 2070 2072 2070 2070 2078 2069 2068 2067 2066 2064 2061 2055 2056 2055 2054 2052 2050 2054 2057 2059 2066 2068 2069 2070 2069 2072 2069 2068 2068]
            [2086 2094 2098 2108 2106 2106 2106 2106 2107 2106 2106 2106 2104 2102 2101 2097 2095 2093 2090 2086 2086 2095 2097 2102 2106 2105 2099 2109 2106 2108 2106 2104 2117 2101 2101 2097 2093 2092 2090 2089 2086 2080 2157 2102 2104 2106 2106 2107 2106 2117 2106 2105 2104 2099 2097 2097 2094]
            % d = 50%
            [1798 1804 1812 1864 1820 1818 1825 1825 1826 1829 1830 1833 1832 1833 1833 1834 1828 1833 1833 1833 1836 1831 1818 1833 1833 1834 1833 1835 1833 1862 1834 1833 1831 1833 1746 1833 1827 1833 1829 1810 1829 1831 1831 1831 1828 1828 1828 1825 1829 1886 1829 1828 1829 1827 1827 1825 1825]
            [1840 1848 1853 1851 1862 1849 1867 1866 1873 1873 1874 1874 1872 1876 1873 1875 1874 1877 1877 1876 1875 1874 1873 1875 1873 1873 1872 1872 1872 1873 1872 1869 1869 1869 1871 1867 1869 1868 1867 1865 1865 1864 1865 1861 1861 1859 1860 1857 1856 1855 1853 1852 1851 1851 1851 1849 1849]
            [1914 1891 1900 1901 1904 1906 1910 1911 1914 1915 1915 1915 1917 1915 1915 1931 1915 1928 1914 1914 1914 1912 1913 1913 1911 1912 1917 1909 1907 1928 1904 1904 1902 1902 1901 1900 1900 1877 1895 1895 1893 1891 1891 1890 1879 1887 1884 1885 1882 1882 1884 1892 1898 1903 1905 1907 1911]
            [1920 1928 1931 1938 1940 1943 1944 1946 1949 1967 1948 1949 1951 1952 1949 1948 1948 1948 1946 1945 1946 1943 1942 1949 1940 1939 1938 1937 1936 1932 1933 1929 1927 1928 1928 1925 1924 1922 1920 1921 1919 1928 1932 1936 1942 1942 1945 1953 1948 1952 1949 1948 1948 2003 1928 1946 1948]
            [1955 1962 1967 1970 1975 1976 1979 1979 1979 1979 1979 1979 1979 1979 1973 1979 1978 1977 1975 1965 1974 1971 1969 1970 1966 1965 1965 1962 1962 1960 1958 1955 1954 1953 1959 1966 1968 1975 1977 1976 1979 1979 1979 1979 1979 1979 1978 1978 1979 1978 1978 1975 1974 1971 1971 1968 1968]
            [2000 2004 2007 2014 2017 2017 2019 2019 2021 2022 2022 2020 2021 2019 2027 2019 2017 2016 2015 2013 2013 2022 2007 2005 2004 1980 1999 1999 1961 2001 2005 2011 2015 2016 2017 2019 2021 2021 2019 2022 2019 2030 2020 2018 2017 2017 2015 2000 2004 2009 2006 2005 2004 2003 2003 1996 1996]
            [2029 2032 2038 2043 2044 2047 2047 2048 2050 2070 2050 2050 2048 2046 2045 2044 2042 2027 2038 2035 2034 2031 2030 2030 2027 2027 2034 2038 2039 2046 2047 2047 2048 2048 2051 2049 2045 2040 2045 2046 2040 2050 2040 2037 2037 2032 2051 2030 2029 2076 2028 2031 2038 2040 2030 2045 2046]
            [2066 2070 2076 2079 2081 2081 2055 2085 2082 2084 2082 2082 2082 2081 2079 2080 2077 2075 2070 2069 2069 2066 2062 2055 2074 2078 2080 2080 2081 2082 2082 2083 2082 2081 2081 2079 2079 2078 2075 2073 2068 2069 2066 2066 2061 2068 2074 2077 2080 2081 2081 2082 2082 2088 2082 2082 2134]
            [2101 2106 2112 2113 2118 2119 2098 2121 2119 2119 2119 2118 2115 2113 2110 2106 2106 2106 2101 2156 2097 2105 2107 2112 2112 2110 2111 2112 2110 2111 2108 2106 2106 2106 2105 2105 2101 2099 2096 2095 2097 2101 2107 2109 2111 2114 2115 2117 2110 2114 2128 2110 2142 2109 2106 2105 2104]
            % d = 60%
            [1813 1817 1821 1825 1825 1829 1830 1833 1837 1837 1837 1840 1877 1839 1845 1844 1849 1844 1837 1844 1843 1833 1845 1844 1843 1842 1844 1844 1844 1846 1843 1845 1844 1844 1844 1842 1841 1842 1837 1846 1844 1842 1843 1841 1844 1818 1842 1841 1841 1842 1840 1840 1841 1839 1843 1837 1840]
            [1851 1861 1864 1871 1877 1877 1879 1880 1882 1887 1884 1886 1885 1885 1885 1902 1887 1885 1877 1884 1890 1884 1882 1882 1895 1882 1882 1881 1885 1881 1878 1882 1881 1878 1877 1881 1876 1877 1877 1876 1877 1877 1877 1874 1874 1876 1873 1871 1869 1868 1869 1865 1865 1864 1864 1863 1860]
            [1895 1902 1908 1913 1915 1932 1922 1922 1922 1927 1927 1924 1923 1927 1927 1925 1925 1925 1924 1927 1924 1924 1922 1920 1960 1920 1919 1919 1916 1916 1916 1916 1915 1913 1913 1910 1909 1908 1875 1904 1902 1902 1902 1902 1901 1898 1896 1895 1895 1892 1895 1924 1907 1888 1907 1920 1920]
            [1932 1940 1945 1949 1952 1953 1954 1957 1959 1958 1953 1902 1958 1959 1958 1958 1956 1955 1958 1954 1953 1954 1953 1953 1953 1952 1935 1949 1948 1948 1943 1943 1941 1938 1940 1936 1935 1932 1932 1930 1932 1940 1944 1950 1953 1953 1955 1955 1957 1955 1967 1958 1991 1957 1955 1956 1955]
            [1966 1977 1979 1981 1987 1990 1991 1992 1992 1993 1994 1991 1993 1991 1990 1991 1991 1991 1989 1988 1986 1983 1984 1981 1979 1979 1979 1975 1975 1973 1970 1970 1965 1965 1973 1979 1981 1986 1987 1990 1940 1987 1993 1991 1993 1991 1991 1993 1991 1991 1990 1989 1987 1989 1987 1983 1981]
            [1948 2015 2017 2021 2027 2022 2030 2030 2030 2030 2030 2030 2030 2029 2029 2028 2026 2017 2025 2028 2022 1978 2018 2017 2015 2013 2012 2007 2007 2011 2017 1991 2026 2027 2032 2029 2030 2030 2030 2030 2029 2030 2029 2029 2026 2025 2022 2019 2019 2019 2017 2015 2015 2011 2010 2007 2006]
            [2035 2042 2047 2051 2055 2055 2055 2055 2055 2055 2056 2056 2055 2055 2055 2055 2054 2052 2050 2047 2044 2044 2042 2050 2037 2035 2046 2048 2053 2054 2055 2057 2055 2056 2057 2055 2077 2054 2055 2053 2053 2050 2047 2046 2045 2043 2041 2040 2038 2041 2038 2044 2050 2051 2054 2055 2055]
            [2074 2081 2092 2085 2086 2086 2105 2088 2115 2088 2074 2087 2085 2083 2082 2081 2081 2078 2077 2074 2071 2068 2069 2076 2079 2081 2082 2082 2083 2085 2083 2083 2082 2082 2081 2137 2081 2079 2077 2076 2072 2070 2068 2070 2064 2070 2074 2060 2101 2082 2083 2083 2085 2083 2082 2081 2026]
            [2119 2124 2128 2134 2132 2133 2133 2134 2133 2132 2132 2132 2132 2129 2129 2127 2145 2120 2119 2118 2117 2123 2129 2131 2133 2136 2144 2078 2135 2133 2133 2134 2132 2131 2131 2126 2124 2123 2121 2119 2119 2104 2131 2132 2132 2133 2137 2136 2194 2133 2187 2132 2132 2132 2130 2127 2123]
            % d = 70%
            [1825 1829 1839 1841 1844 1851 1851 1891 1856 1855 1857 1859 1859 1860 1860 1860 1859 1859 1860 1861 1865 1860 1858 1858 1859 1858 1857 1856 1826 1861 1857 1856 1853 1853 1857 1853 1856 1853 1853 1856 1852 1866 1866 1853 1851 1851 1852 1855 1851 1863 1852 1851 1849 1851 1851 1851 1865]
            [1867 1872 1877 1881 1887 1889 1879 1893 1894 1895 1898 1897 1896 1897 1898 1900 1897 1898 1897 1895 1900 1896 1895 1896 1895 1895 1896 1892 1892 1892 1891 1891 1888 1890 1891 1900 1889 1888 1887 1887 1885 1885 1886 1883 1884 1882 1882 1882 1881 1881 1878 1877 1877 1877 1877 1877 1876]
            [1905 1915 1920 1923 1928 1928 1913 1932 1935 1936 1935 1936 1976 1936 1936 1933 1932 1932 1932 1932 1932 1941 1930 1929 1928 1928 1928 1927 1927 1927 1925 1926 1926 1924 1920 1924 1902 1920 1923 1919 1916 1912 1914 1916 1912 1911 1911 1908 1909 1905 1924 1915 1920 1927 1928 1932 1932]
            [1944 1952 1955 1960 1963 1966 1910 1970 1968 1970 1968 1969 1971 1966 1970 1966 1969 1967 1968 1966 1965 1965 1963 1963 1960 1962 1959 1960 1959 1957 1955 1955 1953 1956 1953 1951 1948 1948 1944 1943 1948 1953 1955 1960 1963 1966 1999 1967 1967 1971 1971 1971 1971 1971 1968 1967 1967]
            [1980 1989 1993 1987 2002 2004 2005 2004 2005 2004 2005 2005 2004 2008 2004 2003 2003 2002 2000 2000 1999 1997 1995 1995 1995 1993 1993 1989 1987 1987 1983 1983 1979 1979 1983 1991 1997 1999 2003 2003 1997 2005 2004 2004 2004 2004 2004 2003 2003 2010 2003 2000 1999 1997 1996 1995 1993]
            [2009 2017 2021 2028 2030 2030 2030 2031 2032 2034 2032 2031 2031 2030 2030 2030 2030 2029 2027 2026 2026 2022 2022 2020 2019 2017 2025 2015 2011 2017 2022 2025 2030 2030 2030 2032 2032 2033 2032 2031 2031 2034 2030 2030 2030 2029 2028 2026 2025 2025 2022 2019 2050 2017 2016 1957 2011]
            [2044 2051 2055 2059 2059 2062 2066 2003 2066 2066 2066 2066 2063 2058 2064 2059 2059 2056 2055 2055 2054 2048 2050 2048 2052 2046 2053 2056 2060 2059 2061 2061 2063 2063 2081 2064 2063 2051 2061 2059 2057 2041 2055 2055 2053 2050 2050 2048 2048 2046 2045 2051 2046 2059 2060 2062 2064]
            [2074 2081 2082 2086 2093 2090 2090 2093 2093 2092 2090 2089 2091 2086 2086 2083 2083 2082 2080 2080 2077 2074 2081 2078 2107 2086 2086 2088 2092 2091 2090 2086 2090 2090 2086 2088 2086 2079 2082 2082 2081 2077 2077 2074 2072 2078 2081 2086 2086 2090 2091 2091 2091 2093 2090 2090 2089]
            [2110 2113 2132 2121 2124 2125 2126 2126 2125 2124 2124 2125 2121 2119 2118 2118 2115 2112 2109 2108 2107 2117 2118 2119 2121 2098 2126 2124 2123 2124 2121 2123 2120 2119 2118 2117 2117 2112 2109 2106 2107 2141 2118 2120 2121 2124 2124 2125 2124 2123 2124 2123 2121 2120 2119 2118 2117]
            % d = 80%
            [1835 1843 1850 1853 1860 1861 1862 1831 1865 1868 1869 1868 1869 1869 1877 1869 1869 1869 1869 1869 1869 1868 1869 1869 1866 1868 1868 1867 1866 1865 1865 1865 1865 1865 1864 1864 1849 1864 1864 1866 1864 1863 1863 1861 1861 1864 1861 1862 1864 1859 1861 1859 1858 1875 1858 1860 1856]
            [1877 1882 1887 1892 1917 1901 1902 1902 1903 1904 1907 1904 1906 1906 1905 1920 1904 1904 1904 1903 1904 1903 1902 1902 1902 1902 1902 1902 1900 1900 1900 1900 1898 1898 1895 1910 1896 1895 1880 1895 1893 1894 1892 1891 1893 1891 1892 1889 1889 1888 1889 1889 1888 1887 1884 1885 1815]
            [1922 1926 1929 1933 1936 1941 1942 1944 1945 1946 1948 1948 1946 1946 1944 1944 1946 1946 1943 1942 1942 1941 1940 1942 1941 1939 1939 1938 1938 1936 1936 1935 1933 1936 1933 1929 1930 1929 1930 1928 1928 1940 1927 1924 1924 1920 1922 1920 1918 1916 1864 1927 1930 1935 1938 1953 1943]
            [1946 1953 1957 1963 1964 1981 1968 1967 1970 1970 1971 1971 1971 1971 1968 1970 1967 1967 1966 1966 1965 1957 1964 1963 1960 1961 1958 1955 1956 1957 1955 1954 1953 1953 1952 1950 1948 1948 1945 1943 1946 1953 1955 1961 1966 1965 1967 1969 1967 1971 1970 1968 1970 1967 1969 1968 1967]
            [1982 1989 1993 1997 2002 2002 2004 2004 2004 2004 2004 2004 2004 2003 2003 2001 2003 2001 2005 1997 1997 1995 1997 1993 1993 1991 1990 1990 1987 1987 1983 1982 1981 1979 1986 1991 1996 2000 2000 2003 2004 2016 2005 2004 2004 2003 2003 2000 2002 2002 2000 1994 1997 1997 1995 1995 1993]
            [2010 2017 2021 2022 2028 2028 2029 2029 2030 2030 2030 2030 2030 2029 2030 2030 2005 2027 2025 2026 2010 2022 2019 2019 2018 2024 2016 2015 2011 2016 2018 2025 2026 2029 2030 2030 2030 1971 2030 2030 2030 2029 2029 2026 2025 2024 2022 2022 2006 2021 2017 2017 2015 2015 2014 2014 2007]
            [2044 2054 2054 2056 2044 2059 2062 2061 2057 2063 2014 2065 2060 2060 2059 2056 2058 2055 1979 2054 2053 2054 2050 2048 2046 2044 2054 2055 2058 2061 2060 2063 2127 2063 2062 2062 2083 2061 2057 2056 2056 2055 2055 2054 2053 2051 2050 2047 2045 2042 2045 2051 2055 2041 2058 2059 2058]
            [2065 2072 2073 2079 2081 2081 2082 2081 2081 2081 2081 2078 2077 2076 2075 2075 2073 2070 2068 2062 2067 2064 2061 2068 2073 2075 2078 2079 2078 2080 2080 2079 2081 2078 2077 2074 2074 2057 2070 2076 2069 2068 2067 2059 2062 2068 2072 2077 2076 2079 2080 2096 2078 2080 2069 2078 2077]
            [2096 2102 2106 2108 2108 2108 2109 2112 2107 2108 2107 2106 2106 2105 2105 2104 2101 2101 2096 2095 2095 2101 2107 2106 2108 2110 2110 2110 2108 2109 2107 2108 2106 2105 2105 2105 2102 2099 2096 2094 2097 2102 2106 2124 2109 2109 2109 2108 2109 2108 2106 2106 2105 2106 2105 2103 2099]
            % d = 90%
            [1851 1855 1863 1866 1869 1875 1876 1875 1877 1877 1882 1878 1879 1861 1880 1879 1881 1879 1887 1881 1880 1879 1879 1877 1880 1900 1879 1877 1877 1877 1877 1877 1877 1876 1877 1876 1877 1874 1874 1874 1873 1875 1871 1873 1873 1869 1872 1868 1869 1869 1869 1869 1869 1869 1866 1865 1871]
            [1881 1895 1894 1897 1902 1932 1904 1906 1908 1908 1884 1909 1908 1909 1906 1908 1907 1907 1907 1911 1906 1904 1904 1905 1903 1904 1904 1903 1902 1902 1920 1888 1831 1901 1900 1900 1899 1898 1898 1890 1898 1896 1875 1895 1892 1894 1891 1891 1891 1890 1888 1891 1888 1889 1888 1889 1888]
            [1913 1919 1926 1928 1930 1933 1938 1936 1939 2019 1936 1940 1939 1938 1938 1932 1940 1937 1936 1936 1936 1936 1930 2002 1930 1930 1965 1928 1877 1928 1936 1928 1927 1926 1925 1926 1924 1924 1922 1923 1911 1920 1872 1917 1915 1916 1915 1914 1915 1913 1915 1923 1928 1928 1930 1935 1933]
            [1942 1949 1953 1955 1999 1959 1962 1962 1964 1963 1964 1965 1963 1962 1962 1962 1984 1960 1957 1958 1957 1955 1957 1954 1953 1953 1953 1952 1977 1975 1951 1869 1948 1948 1946 1944 1944 1943 1944 1941 1942 1950 1953 1953 1958 1962 1961 1963 1963 1962 1979 1962 1963 1961 1961 1961 1955]
            [1968 1977 1979 1983 1986 1987 1989 1989 1990 1989 1989 1987 1989 1987 1987 1984 1983 1984 1983 1981 1979 1979 1979 1979 1979 1978 1976 1975 1975 1974 1971 1972 1968 1967 1973 1979 1983 1987 1987 1987 1987 1991 1989 1990 2054 1988 2047 1987 1980 1979 1984 1981 1979 1981 1979 1979 1979]
            [1990 1989 1999 2001 2004 2004 2005 1991 2006 2005 2004 2005 2005 2004 2003 2003 2003 2003 1999 1997 1997 2003 2002 1994 1992 1991 1990 1990 1987 1991 1996 2000 2003 2004 2004 2005 2006 2005 2006 2004 2004 2004 2002 2003 1995 2002 2002 2002 1999 1953 1995 2006 1993 1992 1992 1990 1988]
            [2018 2024 2027 2029 2030 2030 2030 2030 2030 2030 2030 2030 2030 2029 2029 2028 2027 2026 2022 2019 2020 2019 2019 2018 2017 2017 2024 2027 2030 2030 2030 2030 2032 2031 2073 2027 2030 2030 2029 2028 2027 2026 2026 2022 2022 2019 2019 2019 2048 2015 2018 2022 2026 2028 2029 2030 2031]
            [2038 2043 2044 2047 2050 2052 2051 2050 2050 2050 2051 2079 2047 2046 2045 2044 2042 2040 2040 2039 2038 2034 2034 2038 2044 2046 2050 2047 2053 2049 2048 2048 2047 2050 2046 2046 2045 2042 2044 1981 2040 2038 2031 2038 2030 1996 2043 2046 2046 2050 2051 2051 2051 2050 2048 2053 2046]
            [2059 2063 2066 2068 2070 2072 2066 2070 2069 2069 2069 2067 2066 2066 2064 2063 2047 2059 2058 2056 2057 2061 2063 2068 2068 2078 2063 2070 2069 2068 2067 2068 2068 2066 2064 2060 2056 2059 2058 2056 2058 2004 2067 2068 2069 2069 2068 2069 2068 2068 2069 2056 2064 2063 2064 2061 2059]];

CUR_MEAN = mean(CUR_MEAS,2);
% 200 is the gain of the INA241A5
% 75 * 10^(-3) is the value of the current sensing resistor
CUR_VAL = CUR_MEAN(:,1) * 10^(-3) / 200 / (75 * 10^(-3));

S_ANGLE_V = zeros(9,9);
S_TRANS_V = zeros(9,9);
S_CURRENT = zeros(9,9);
S_POWER_C = zeros(9,9);
S_ANGLE_EFF = zeros(9,9);
S_TRANS_EFF = zeros(9,9);

% looping over duty cycle
for d = 1:9
    % initialize frequency array index
    f = 1;
    
    % looping over frequency
    for freq = 10:5:50
        % read in the Vicon .csv file
        M = readtable('C:\Users\alexn\Documents\senior_thesis\actuator2\actuator2 f'+string(freq)+' d'+string(d)+'.csv', 'ReadVariableNames', false);
        numRows = height(M) + 2;
        M = readmatrix('C:\Users\alexn\Documents\senior_thesis\actuator2\actuator2 f'+string(freq)+' d'+string(d)+'.csv', 'Range', 'A6:H'+string(numRows));

        % unit processing
        M(:,2) = M(:,1) / 120;
        M(:,3) = M(:,3) * 180 / pi;
        M(:,4) = M(:,4) * 180 / pi;
        M(:,5) = M(:,5) * 180 / pi;

        % smoothing
        S = smoothdata(M,"gaussian",120); % window size of 120 to match frame/sampling rate

        % find valid initial and final indices
        firstValidIndex = find(~isnan(M(:,5)), 1);
        lastValidIndex = find(~isnan(M(:,5)), 1, 'last');

        % calculate angular velocity
        S_ANGLE_V(d,f) = (S(lastValidIndex, 5) - S(firstValidIndex, 5)) / 15;
        
        % calculate magnitude of translational velocity
        v_x = (S(lastValidIndex, 6) - S(firstValidIndex, 6)) / 15;
        v_y = (S(lastValidIndex, 7) - S(firstValidIndex, 7)) / 15;
        S_TRANS_V(d,f) = sqrt(v_x^2 + v_y^2);

        % calculate current consumption and power
        S_CURRENT(d,f) = CUR_VAL((d-1)*9 + f, 1);
        S_POWER_C(d,f) = S_CURRENT(d,f) * 7.4; % 7.4 is the total input voltage to eViper


        S_ANGLE_EFF(d,f) = abs(S_ANGLE_V(d,f)) / S_POWER_C(d,f);
        S_TRANS_EFF(d,f) = S_TRANS_V(d,f) / S_POWER_C(d,f);

        % increment frequency array indexing
        f = f + 1;
    end
    
end


%%
% initialize frames to measure average velocities from
init_start = 1;
init_end = 50;
final_start = 2100;
final_end = 2150;

% import for all docs
% num = 2;
% M = readtable('C:\Users\alexn\Documents\senior_thesis\3_06_2024\3_06_2024 actuator4 '+string(num)+'.csv', 'ReadVariableNames', false);
% numRows = height(M) + 2;
% M = readmatrix('C:\Users\alexn\Documents\senior_thesis\3_06_2024\3_06_2024 actuator4 '+string(num)+'.csv', 'Range', 'A6:H'+string(numRows));

freq = 45;
duty = 6;
M = readtable('C:\Users\alexn\Documents\senior_thesis\actuator2\actuator2 f'+string(freq)+' d'+string(duty)+'.csv', 'ReadVariableNames', false);
numRows = height(M) + 2;
M = readmatrix('C:\Users\alexn\Documents\senior_thesis\actuator2\actuator2 f'+string(freq)+' d'+string(duty)+'.csv', 'Range', 'A6:H'+string(numRows));

% unit processing
M(:,2) = M(:,1) / 120;
M(:,3) = M(:,3) * 180 / pi;
M(:,4) = M(:,4) * 180 / pi;
M(:,5) = M(:,5) * 180 / pi;

% smoothing
S = smoothdata(M,"gaussian",120); % window size of 120 to match frame/sampling rate

% unsmoothed
close all;
figure(1);
subplot(2, 2, 1);
% plot(M(:,1), M(:,3));
% hold on;
% plot(M(:,1), M(:,4));
plot(M(:,1), M(:,5));
% legend({'angular disp. in X dir. (degree)', 'angular disp. in Y dir. (degree)', 'angular disp. in Z dir. (degree)'}, 'Location', 'east');
legend({'angular pos. in degrees'});
grid minor;
grid on;
hold off;

subplot(2, 2, 3);
plot(M(:,1), M(:,6));
legend({'X pos. (mm)'});
grid minor;
grid on;
hold off;

subplot(2, 2, 4);
plot(M(:,1), M(:,7));
legend({'Y pos. (mm)'});
grid minor;
grid on;
hold off;

sgtitle('actuator 4, frequency '+string(freq)+', duty cycle '+string(duty));

% smoothed
figure(2);
subplot(2, 2, 1);
% plot(M(:,1), M(:,3));
% hold on;
% plot(M(:,1), M(:,4));
plot(S(:,1), S(:,5));
% legend({'angular disp. in X dir. (degree)', 'angular disp. in Y dir. (degree)', 'angular disp. in Z dir. (degree)'}, 'Location', 'east');
legend({'angular pos. in degrees'});
grid minor;
grid on;
hold off;

subplot(2, 2, 3);
plot(S(:,1), S(:,6));
legend({'X pos. (mm)'});
grid minor;
grid on;
hold off;

subplot(2, 2, 4);
plot(S(:,1), S(:,7));
legend({'Y pos. (mm)'});
grid minor;
grid on;
hold off;

sgtitle('smoothed actuator 4, frequency '+string(freq)+', duty cycle '+string(duty));

% smoothed
figure(3);
subplot(2, 2, 1);
% plot(M(:,1), M(:,3));
% hold on;
% plot(M(:,1), M(:,4));
plot(M(:,1), M(:,5));
hold on;
plot(S(:,1), S(:,5));
% legend({'angular disp. in X dir. (degree)', 'angular disp. in Y dir. (degree)', 'angular disp. in Z dir. (degree)'}, 'Location', 'east');
legend({'angular pos. in degrees', 'smoothed angular pos. in degrees'});
grid minor;
grid on;
hold off;

subplot(2, 2, 3);
plot(M(:,1), M(:,6));
hold on;
plot(S(:,1), S(:,6));
legend({'X pos. (mm)', 'smoothed X pos. (mm)'});
grid minor;
grid on;
hold off;

subplot(2, 2, 4);
plot(M(:,1), M(:,7));
hold on;
plot(S(:,1), S(:,7));
legend({'Y pos. (mm)', 'smoothed Y pos. (mm)'});
grid minor;
grid on;
hold off;

sgtitle('smoothed vs unsmoothed actuator 4, frequency '+string(freq)+', duty cycle '+string(duty));

firstValidIndex = find(~isnan(M(:,5)), 1);
lasValidIndex = find(~isnan(M(:,5)), 1, 'last');
%%
% calculate angular velocity
init_angle = mean(M(init_start:init_end,5), "all");
final_angle = mean(M(final_start:final_end,5), "all");
avg_angle_vel = (final_angle - init_angle) / 15;
disp("ANGLE: ");
% disp(init_angle);
% disp(final_angle);
disp(avg_angle_vel);

% calculate x velocity
init_x = mean(M(init_start:init_end,6), "all");
final_x = mean(M(final_start:final_end,6), "all");
avg_x_vel = (final_x - init_x) / 15;
disp("X: ");
% disp(init_x);
% disp(final_x);
disp(avg_x_vel);

% calculate y velocity
init_y = mean(M(init_start:init_end,7), "all");
final_y = mean(M(final_start:final_end,7), "all");
avg_y_vel = (final_y - init_y) / 15;
disp("Y: ");
% disp(init_y);
% disp(final_y);
disp(avg_y_vel);
