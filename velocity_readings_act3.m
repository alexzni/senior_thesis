CUR_MEAS = [% d = 10%
            [1683 1689 1698 1702 1708 1712 1715 1719 1723 1723 1723 1726 1726 1728 1727 1731 1726 1729 1727 1729 1729 1726 1727 1728 1729 1727 1726 1727 1726 1724 1727 1725 1726 1723 1723 1715 1723 1724 1723 1701 1724 1723 1728 1723 1723 1723 1713 1723 1731 1722 1720 1719 1722 1722 1719 1721 1719]
            [1681 1690 1698 1702 1709 1711 1713 1718 1720 1725 1723 1723 1723 1723 1726 1723 1723 1723 1723 1723 1723 1723 1723 1723 1723 1804 1723 1721 1723 1723 1723 1722 1721 1721 1723 1721 1721 1719 1721 1721 1721 1722 1719 1719 1720 1718 1719 1716 1716 1716 1715 1716 1716 1715 1715 1713 1713]
            [1674 1691 1698 1700 1706 1711 1715 1715 1721 1719 1721 1719 1722 1723 1723 1723 1722 1722 1722 1722 1722 1721 1722 1721 1719 1735 1745 1719 1720 1722 1719 1719 1716 1719 1719 1719 1716 1715 1719 1716 1715 1715 1718 1715 1715 1714 1715 1716 1713 1714 1719 1715 1735 1740 1743 1753 1749]
            [1624 1689 1696 1702 1697 1711 1711 1715 1715 1720 1718 1719 1721 1719 1723 1721 1719 1722 1719 1723 1719 1719 1718 1718 1718 1718 1719 1718 1719 1716 1716 1719 1715 1716 1715 1715 1715 1716 1714 1715 1720 1724 1732 1738 1742 1747 1767 1751 1750 1750 1753 1751 1751 1751 1752 1750 1750]
            [1682 1690 1698 1700 1707 1710 1711 1713 1715 1715 1715 1716 1719 1719 1721 1722 1716 1713 1703 1719 1719 1716 1716 1718 1719 1719 1718 1716 1716 1716 1747 1715 1715 1716 1723 1731 1736 1743 1747 1748 1750 1749 1750 1750 1750 1751 1740 1751 1750 1750 1750 1725 1749 1750 1749 1749 1750]
            [1912 1918 1908 1928 1929 1930 1932 1931 1936 1932 1932 1930 1979 1929 1929 1928 1927 1926 1924 1926 1920 1918 1916 1917 1916 1914 1912 1910 1910 1917 1920 1927 1929 1932 1935 1940 1932 1932 1932 1929 1929 1951 1926 1928 1928 1927 1926 1923 1922 1918 1917 1915 1915 1853 1913 1912 1911]
            [1671 1675 1679 1686 1689 1693 1695 1698 1698 1702 1701 1705 1710 1706 1707 1709 1707 1716 1709 1709 1708 1708 1710 1709 1708 1710 1715 1723 1723 1726 1728 1734 1735 1737 1737 1739 1742 1740 1741 1674 1742 1743 1742 1742 1741 1744 1742 1741 1740 1741 1747 1751 1761 1770 1774 1774 1775]
            [1673 1681 1690 1697 1698 1703 1705 1706 1707 1718 1710 1710 1707 1710 1710 1711 1710 1710 1710 1710 1710 1710 1710 1719 1724 1731 1734 1738 1739 1741 1731 1743 1747 1754 1746 1745 1743 1742 1745 1743 1743 1742 1744 1742 1743 1750 1758 1761 1772 1774 1774 1776 1776 1813 1776 1777 1777]
            [1674 1683 1686 1693 1697 1699 1700 1702 1703 1707 1707 1709 1710 1710 1711 1711 1711 1710 1712 1712 1716 1711 1726 1749 1732 1736 1739 1814 1745 1744 1743 1745 1747 1747 1748 1747 1747 1749 1749 1747 1749 1759 1772 1774 1774 1777 1777 1778 1780 1780 1780 1780 1781 1733 1782 1783 1782]
            % d = 20%
            [1766 1774 1778 1786 1789 1793 1797 1799 1801 1802 1802 1805 1806 1809 1808 1809 1809 1809 1808 1810 1810 1808 1810 1808 1808 1808 1809 1808 1806 1804 1805 1804 1802 1802 1802 1800 1800 1800 1800 1798 1798 1798 1796 1796 1798 1794 1795 1793 1790 1793 1790 1790 1790 1790 1790 1788 1786]
            [1805 1813 1817 1825 1825 1827 1831 1836 1834 1825 1838 1855 1840 1842 1842 1841 1841 1841 1839 1839 1840 1846 1837 1836 1837 1835 1833 1833 1833 1830 1829 1828 1828 1826 1825 1825 1825 1825 1825 1821 1823 1821 1815 1820 1817 1818 1815 1814 1815 1813 1813 1813 1812 1812 1812 1810 1808]
            [1840 1849 1851 1869 1861 1865 1877 1869 1873 1873 1873 1873 1877 1876 1873 1873 1869 1869 1871 1869 1869 1865 1864 1865 1864 1864 1862 1859 1857 1852 1863 1855 1855 1852 1851 1851 1841 1851 1849 1849 1848 1843 1845 1844 1844 1841 1841 1839 1817 1839 1839 1847 1855 1858 1865 1865 1868]
            [1877 1902 1891 1896 1901 1902 1904 1904 1908 1908 1908 1907 1908 1907 1908 1904 1903 1902 1902 1902 1901 1900 1899 1896 1900 1893 1892 1890 1892 1888 1888 1888 1884 1877 1881 1881 1878 1880 1878 1877 1879 1888 1892 1900 1901 1902 1888 1908 1906 1910 1911 1909 1907 1906 1906 1905 1903]
            [1900 1917 1926 1928 1931 1932 1935 1959 1939 1940 1940 1937 1936 1936 1933 1933 1932 1929 1927 1928 1927 1925 1924 1924 1920 1919 1916 1882 1915 1912 1913 1911 1906 1908 1916 1922 1927 1927 1932 1935 1938 1936 1936 1940 1936 1936 1933 1932 1931 1932 1928 1928 1925 1928 1925 1924 1922]
            [1948 1953 1959 1965 1905 1967 1971 1971 1967 1971 1971 1971 1968 1967 1967 1966 1966 1963 1962 1961 1957 1957 1954 1953 1952 1952 1902 1948 1945 1951 1955 1962 1965 1967 1968 1970 1971 1971 1971 1971 1970 1970 1967 1966 1964 1967 1959 1961 1957 1955 1953 1953 1953 1952 1949 1946 1945]
            [1975 1981 1996 1991 1994 2004 1997 1997 1996 1997 1996 1996 1996 1992 1991 1987 1987 1988 1984 1980 1980 1979 1979 1979 1974 1975 1981 1989 1991 1996 1997 1999 2008 2000 1999 1997 1997 1994 2030 1992 1992 1987 1963 1986 1982 2046 1979 1979 1979 1976 1977 1983 1989 1991 1994 1995 1999]
            [2006 2012 2019 2021 2026 2026 2027 2026 2029 2026 2025 2059 2021 2021 2017 2013 2016 2013 2012 2009 2007 2006 2004 2003 2017 2019 2022 2026 2026 2029 2028 2026 2026 2022 2021 2020 2019 2017 2015 2013 2013 2009 2006 2006 2003 2010 2016 2019 2022 2027 2028 2026 2025 2022 2024 2019 2019]
            [2045 2047 2050 2054 2055 2055 2058 2055 2056 2055 2056 2055 2054 2054 2051 2051 2048 2047 2044 2046 2043 2046 2050 2053 2055 2055 2055 2054 2051 2065 2054 2054 2053 2052 1995 2050 2046 2046 2045 2055 2044 2048 2053 2055 2054 2055 2061 2055 2055 2056 2055 2055 2055 2054 2050 2043 2050]
            % d = 30%
            [1775 1786 1793 1798 1800 1805 1804 1812 1812 1773 1814 1817 1816 1815 1817 1820 1820 1820 1820 1821 1820 1817 1822 1820 1821 1820 1821 1821 1821 1821 1821 1892 1821 1818 1817 1818 1817 1819 1817 1817 1814 1814 1813 1813 1749 1812 1810 1810 1810 1809 1808 1806 1806 1806 1804 1804 1802]
            [1821 1828 1834 1839 1845 1845 1851 1853 1853 1853 1850 1878 1856 1855 1859 1861 1859 1859 1859 1859 1860 1858 1878 1813 1857 1857 1853 1853 1794 1852 1851 1851 1849 1850 1849 1847 1849 1845 1844 1842 1843 1840 1842 1839 1838 1837 1836 1836 1833 1831 1774 1830 1833 1828 1827 1826 1826]
            [1857 1865 1872 1856 1877 1873 1864 1885 1888 1902 1888 1888 1889 1890 1890 1890 1889 1888 1888 1888 1888 1886 1884 1881 1881 1881 1879 1878 1877 1877 1877 1877 1874 1876 1871 1873 1871 1868 1867 1865 1865 1864 1862 1863 1885 1860 1857 1857 1853 1855 1857 1866 1869 1877 1877 1881 1884]
            [1895 1902 1906 1911 1914 1917 1919 1920 1920 1925 1924 1924 1926 1925 1924 1915 1923 1920 1920 1917 1916 1915 1914 1915 1913 1911 1910 1907 1908 1904 1902 1890 1901 1901 1900 1902 1897 1895 1892 1893 1893 1902 1907 1911 1915 1916 1920 1920 1923 1923 1924 1925 1926 1924 1926 1924 1922]
            [1932 1940 1946 1949 1953 1954 1957 1958 1960 1959 1963 1960 1960 1959 1957 1957 1955 1953 1953 1953 1953 1936 1950 1946 1953 1948 1941 1940 1938 1936 1936 1873 1930 1924 1938 1946 1949 1953 1936 1957 1955 1959 1963 1961 1960 1960 1961 1958 1957 1961 1952 1953 1953 1952 1951 1948 1946]
            [1966 1974 1979 1997 1983 1987 1988 1991 1991 1991 1991 1991 1991 1991 1989 1984 1983 1981 1979 1979 1978 1976 1977 1974 1971 1968 1968 1967 1964 1969 1978 1964 1983 1984 2017 1991 1992 1992 1991 1991 1990 1991 1988 1984 1983 1981 1983 1980 1979 1977 1974 1975 1971 1968 1898 1979 1965]
            [2000 2007 2010 2017 2019 2022 2022 2024 2026 1952 2062 2022 2022 2019 2019 2016 2015 2013 1963 2009 2008 2006 2004 2003 2003 1999 2009 2013 2017 2019 2021 2022 2024 2022 2024 2030 2022 2020 2019 2019 2016 2015 2014 2010 2009 2006 2004 2002 2003 2003 2003 2006 2012 2016 2017 2020 2022]
            [2033 2041 2045 2048 2054 2054 2054 2055 2055 2054 2053 2053 2050 2046 2046 2043 2041 2038 2038 2035 2034 2030 2031 2038 2043 2050 2051 2054 2054 2055 2054 2078 2055 2053 2051 2051 2048 2046 1997 2041 2038 2037 2035 2032 2030 1983 2042 2046 2050 2050 2054 2055 2054 2054 2053 2051 2051]
            [2069 2075 2081 2083 2086 2086 2089 2089 2086 2086 2086 2085 2082 2082 2081 2080 2078 2075 2074 2086 2070 2078 2081 2087 2088 2090 2090 2090 2089 2089 2090 2086 2086 2085 2082 2081 2078 2076 2074 2071 2073 2080 2081 2082 2083 2085 2086 2085 2085 2090 2093 2081 2082 2081 2105 2077 2071]
            % d = 40%
            [1774 1798 1802 1829 1811 1816 1817 1821 1829 1822 1825 1825 1825 1825 1825 1825 1826 1826 1826 1824 1827 1825 1826 1826 1826 1825 1825 1826 1828 1828 1828 1826 1827 1825 1829 1877 1827 1825 1827 1826 1827 1826 1825 1825 1824 1825 1825 1820 1824 1823 1821 1821 1818 1817 1817 1815 1815]
            [1835 1839 1863 1852 1853 1858 1860 1861 1864 1865 1856 1866 1869 1868 1868 1869 1869 1868 1869 1866 1869 1872 1869 1868 1867 1869 1869 1867 1865 1866 1864 1866 1863 1862 1861 1865 1858 1857 1855 1925 1853 1881 1852 1852 1851 1851 1849 1849 1847 1847 1845 1844 1844 1841 1841 1789 1840]
            [1871 1878 1884 1888 1893 1833 1899 1900 1902 1902 1902 1903 1903 1903 1902 1904 1902 1905 1903 1902 1897 1902 1902 1900 1900 1900 1898 1900 1894 1893 1892 1893 1891 1888 1888 1885 1884 1882 1881 1881 1879 1877 1877 1877 1876 1875 1873 1846 1872 1872 1874 1879 1884 1890 1891 1902 1889]
            [1914 1919 1926 1928 1932 1932 1936 1939 1958 1941 1941 1940 1943 1941 1941 1941 1940 1941 1938 1948 1936 1933 1935 1932 1930 1932 1928 1928 1928 1926 1924 1923 1921 1920 1917 1917 1915 1914 1911 1912 1912 1920 1927 1928 1932 1936 1938 1938 1990 1941 1942 1941 1941 1941 1941 1940 1948]
            [1949 1953 1963 1965 1967 1970 1971 1975 1975 1974 1974 1975 1976 1974 1975 1986 1971 1968 1968 1971 1966 1966 1963 1962 1959 1959 1954 1955 1953 1953 1952 1949 1951 1946 1953 1930 1963 1966 1970 1970 1970 1974 1974 1957 1975 1975 1975 1975 1974 1971 1971 1969 1967 1968 1965 1964 1936]
            [1979 1986 1991 2050 1999 2002 2003 2004 2004 1976 2005 2004 2004 2004 2003 2002 1999 1999 1996 1995 2003 1990 1991 1984 1986 1983 1980 1979 2027 1982 1990 1993 1994 2003 2003 2004 2004 2004 2004 2004 2004 2004 2002 2004 2000 1999 1995 1993 1994 1990 1988 1987 1986 1982 1981 1979 1979]
            [2017 2022 2029 2030 2031 2034 2038 2038 2038 2039 2038 2038 2037 2035 2033 2031 2030 2030 2027 2026 2025 2020 2015 2017 2016 2017 2023 2030 2030 2030 2034 2034 2038 2038 2038 2035 2038 2035 2034 2034 2026 2030 2032 2026 2022 2022 2019 2018 2017 2017 2017 2022 2026 2031 2032 2035 2034]
            [2056 2060 2066 2066 2067 2070 2070 2070 2071 2072 2064 2070 2070 2070 2069 2068 2067 2061 2066 2059 2061 2058 2068 2066 2062 2067 2069 2070 2082 2077 2072 2073 2072 2073 2070 2070 2055 2069 2057 2066 2065 2064 2061 2059 2056 2061 2066 2066 2068 2069 2070 2097 2070 2070 2070 2070 2070]
            [2091 2097 2095 2105 2106 2106 2109 2108 2107 2109 2104 2106 2106 2106 2105 2102 2099 2097 2096 2093 2092 2099 2105 2106 2108 2108 2110 2133 2110 2110 2109 2109 2106 2105 2104 2101 2096 2097 2093 2137 2094 2096 2099 2104 2105 2106 2105 2106 2106 2106 2106 2105 2102 2102 2099 2099 2095]
            % d = 50%
            [1800 1809 1813 1817 1825 1826 1828 1830 1803 1825 1833 1837 1837 1838 1845 1837 1840 1840 1845 1840 1839 1896 1834 1838 1838 1884 1838 1850 1838 1841 1838 1906 1874 1837 1837 1838 1837 1837 1837 1837 1822 1837 1836 1837 1836 1837 1835 1838 1834 1836 1837 1833 1833 1833 1830 1830 1830]
            [1847 1851 1857 1863 1864 1870 1872 1874 1876 1880 1877 1877 1877 1877 1877 1878 1877 1877 1878 1878 1877 1877 1859 1878 1877 1877 1877 1876 1877 1877 1877 1877 1875 1875 1874 1884 1874 1872 1871 1869 1869 1869 1868 1866 1865 1865 1865 1861 1861 1860 1857 1857 1857 1855 1853 1851 1852]
            [1818 1891 1899 1902 1904 1895 1912 1913 1912 1913 1913 1915 1915 1915 1915 1916 1914 1914 1915 1914 1914 1877 1911 1912 1911 1912 1911 1909 1907 1906 1908 1905 1904 1902 1902 1901 1902 1900 1895 1895 1893 1892 1894 1891 1890 1888 1885 1888 1884 1882 1885 1893 1901 1902 1906 1908 1910]
            [1923 1928 1932 1902 1940 1945 1946 1948 1950 1950 1948 1952 1952 1951 1949 1953 1948 1949 1949 1948 1948 1946 1945 1944 1941 1942 1938 1939 1939 1951 1937 1931 1933 1928 1928 1928 1920 1923 1921 1920 1922 1928 1936 1959 1942 1944 1946 1947 1946 1949 1951 1895 1951 1952 1949 1951 1950]
            [1967 1975 2018 1983 1990 1989 1991 2003 1993 1994 1994 1994 1993 1994 1991 1943 1993 1991 1991 1990 1988 1986 1987 1981 1979 1979 1974 1979 1976 1974 1971 1970 1971 1967 1976 1976 1982 1987 1989 1995 1991 1994 1994 1994 1994 1993 1993 1994 1994 1992 1991 1991 1989 1987 1987 1982 1983]
            [1999 2004 2066 2016 2017 2018 2019 2019 2022 2021 2022 2022 2019 2022 2019 2019 2017 2017 2016 2015 2010 2010 2008 2006 2005 2004 2001 2001 1999 2004 2007 2012 2016 2017 2021 2019 2021 2022 2022 2024 2021 2022 2020 2019 2020 2017 2016 2016 2012 2014 2008 2008 2004 2004 2004 2002 1999]
            [2041 2043 2046 2048 2050 2054 2053 2054 2052 2038 2055 2054 2054 2051 2053 2043 2047 2047 2044 2044 2042 2042 2038 2040 2037 2038 2042 2043 2046 2048 2051 2048 2051 2053 2054 2054 2055 2055 2055 2054 2051 2051 2050 2046 2046 2046 2044 2041 2040 2038 2039 2046 2049 2052 2054 2055 2055]
            [2076 2080 2081 2085 2083 2084 2086 2083 2087 2068 2086 2085 2086 2086 2083 2084 2082 2081 2082 2076 2077 2076 2073 2079 2081 2083 2085 2085 2086 2088 2104 2090 2097 2089 2084 2085 2085 2082 2082 2081 2081 2083 2077 2077 2074 2079 2081 2067 2084 2086 2085 2086 2085 2086 2088 2085 2085]
            [2106 2111 2117 2119 2121 2122 2121 2121 2121 2122 2120 2120 2121 2120 2117 2114 2106 2109 2106 2106 2106 2157 2117 2119 2123 2121 2124 2124 2124 2125 2114 2121 2119 2118 2115 2115 2111 2094 2106 2105 2106 2111 2117 2119 2121 2122 2122 2123 2121 2121 2121 2119 2119 2118 2116 2131 2111]
            % d = 60%
            [1814 1821 1825 1830 1834 1838 1841 1851 1837 1847 1849 1851 1851 1850 1851 1851 1851 1851 1851 1851 1853 1851 1851 1851 1852 1884 1851 1851 1851 1851 1851 1851 1851 1851 1850 1851 1851 1850 1848 1851 1851 1847 1886 1847 1849 1849 1851 1852 1847 1846 1824 1845 1845 1895 1844 1845 1844]
            [1857 1864 1871 1879 1878 1881 1884 1887 1888 1884 1890 1929 1888 1891 1889 1894 1890 1890 1891 1891 1889 1889 1888 1890 1890 1890 1888 1886 1887 1888 1888 1886 1885 1885 1884 1857 1882 1881 1881 1881 1884 1882 1881 1878 1878 1877 1877 1877 1876 1875 1881 1871 1870 1869 1867 1866 1865]
            [1896 1903 1909 1914 1915 1918 1922 1925 1925 1926 1927 1927 1927 1927 1927 1927 1928 1927 1926 1925 1928 1923 1920 1924 1922 1922 1918 1920 1936 1917 1922 1916 1916 1915 1913 1911 1912 1908 1909 1907 1904 1904 1902 1909 1901 1900 1898 1898 1897 1885 1898 1903 1908 1914 1916 1894 1924]
            [1935 1940 1948 1901 1953 1955 1959 1959 1961 1962 1962 1962 1960 1989 1961 1959 1959 1958 1959 1955 1956 1955 1954 1955 1953 1953 1952 1952 1953 1949 1946 1944 1942 1940 1940 1939 1936 1932 1932 1932 1933 1941 1948 1952 1953 1955 1957 1959 1960 1960 1961 1962 1962 1961 1963 1961 1957]
            [1979 1986 1991 1996 1996 2003 1979 2005 2004 2032 2005 2004 2006 2005 2010 2004 2004 2004 2003 2003 2002 1999 2004 1999 1995 1994 1991 1990 1990 1987 1983 1981 1979 1983 1984 1991 1995 2002 2004 2005 2004 2004 2005 2004 2004 2007 2005 2004 2010 2003 2004 2003 2003 2002 1999 2000 1953]
            [2002 2015 2020 2024 2028 2030 2030 2017 2031 2031 2032 2031 2034 2031 2030 2030 2030 2030 2017 2026 2025 2024 2020 2019 2018 2017 2014 2011 2082 2015 2018 2023 2026 2028 2030 2024 2030 2034 2031 2033 2030 2030 2030 2030 2030 2022 2028 2027 2024 1963 2005 2019 2022 2002 2012 2011 2008]
            [2050 2093 2055 2057 2062 2060 2055 2064 2066 2066 2064 2066 2066 2077 2063 2063 2063 2061 2060 2058 2056 2055 2033 2054 2052 2054 2056 2057 2060 2061 2030 2062 2064 2053 2066 2066 2063 2062 2064 2060 2050 2062 2060 2056 2056 2057 2055 2054 2050 2048 2051 2054 2057 2058 2050 2064 2064]
            [2077 2081 2083 2092 2092 2118 2068 2094 2095 2094 2094 2093 2091 2090 2094 2089 2086 2086 2082 2081 2078 2077 2077 2081 2085 2089 2092 2093 2094 2094 2096 2096 2079 2093 2096 2093 2089 2088 2086 2084 2082 2080 2079 2035 2078 2079 2085 2089 2092 2094 2093 2094 2090 2094 2095 2093 2093]
            [2121 2125 2132 2133 2134 2137 2137 2141 2137 2136 2136 2133 2134 2133 2132 2132 2128 2126 2121 2120 2119 2127 2132 2132 2136 2135 2137 2136 2137 2137 2140 2136 2134 2133 2132 2130 2128 2127 2124 2121 2121 2132 2132 2133 2136 2137 2139 2140 2121 2139 2136 2134 2133 2134 2132 2131 2130]
            % d = 70%
            [1826 1833 1841 1845 1849 1823 1853 1859 1843 1859 1861 1862 1864 1863 1864 1864 1864 1843 1862 1864 1862 1862 1863 1863 1863 1863 1862 1861 1862 1861 1860 1861 1861 1860 1858 1862 1892 1859 1859 1857 1859 1806 1857 1857 1854 1854 1855 1855 1857 1854 1853 1855 1853 1856 1853 1853 1853]
            [1871 1877 1881 1888 1892 1892 1899 1898 1900 1901 1901 1902 1902 1903 1902 1902 1903 1902 1902 1901 1902 1913 1901 1902 1900 1900 1900 1900 1898 1900 1896 1836 1893 1896 1895 1894 1895 1892 1893 1893 1841 1892 1891 1890 1888 1888 1888 1889 1888 1887 1885 1884 1885 1882 1881 1878 1877]
            [1908 1914 1919 1924 1928 1929 1933 1936 1933 1936 1931 1938 1938 1936 1937 1936 1936 1936 1934 1933 1932 1930 1932 1929 1929 1928 1929 1928 1928 1928 1928 1927 1927 1925 1924 1924 1924 1920 1919 1918 1917 1916 1915 1914 1900 1914 1909 1907 1907 1904 1906 1916 1920 1927 1928 1927 1932]
            [1949 1954 1957 1965 1966 1967 1970 1970 1972 1967 1974 1971 1975 1971 1971 1970 1987 1967 1967 1966 1932 1966 1964 1963 1965 1963 1990 1960 1962 1958 1957 1956 1955 1953 1954 1951 1948 1948 1945 1948 1946 1953 1958 1967 1969 1967 1909 1968 1971 1921 1910 1974 1974 1973 1970 1971 1970]
            [1991 1999 2004 2007 2009 2013 2082 2017 2017 2017 2017 2017 2017 2016 2016 2015 2015 2012 2012 2010 2009 1996 2007 2004 2006 2004 2003 2003 2003 1997 1996 1994 1992 2011 1999 2003 2005 2008 2012 2013 2015 2015 2016 2017 2016 2015 2015 2015 2016 2010 2006 2011 2010 2007 2006 2007 2004]
            [2019 2023 2028 2030 2032 2035 2038 2040 2038 2040 2038 2040 2038 2038 2040 2036 2038 2032 2033 2032 2030 2030 2030 2024 2017 2025 2025 2019 2019 2022 2028 2030 2030 2064 2032 2032 2034 2032 2030 2030 2031 2031 2030 2030 2090 2029 2030 2030 2029 2026 2025 2022 2023 2096 2018 2017 2015]
            [2046 2054 2055 2059 2061 2063 2064 2066 2015 2066 2062 2066 2064 2065 2063 2061 2060 2058 2057 2056 2055 2055 2054 2050 2047 2047 2055 2057 2060 2060 2066 2066 2065 2065 2064 2038 2080 2064 2061 2041 2060 2059 2055 2055 2054 2054 2051 2047 2046 2043 2046 2053 2056 2059 2061 2064 2066]
            [2078 2084 2086 2090 2093 2092 2092 2094 2093 2094 2093 2093 2093 2093 2090 2086 2089 2086 2083 2082 2088 2091 2081 2083 2088 2089 2092 2094 2093 2093 2093 2095 2095 2095 2070 2093 2092 2093 2090 2089 2082 2085 2082 2083 2082 2086 2089 2091 2104 2094 2106 2097 2095 2095 2093 2094 2093]
            [2129 2133 2134 2134 2132 2137 2141 2139 2139 2139 2137 2139 2137 2137 2133 2133 2132 2131 2130 2128 2128 2130 2132 2133 2134 2142 2149 2137 2137 2136 2142 2133 2132 2132 2132 2132 2121 2129 2127 2125 2126 2132 2137 2169 2141 2142 2141 2144 2144 2142 2142 2140 2141 2140 2149 2136 2098]
            % d = 80%
            [1839 1847 1851 1857 1861 1864 1865 1866 1869 1865 1873 1873 1874 1916 1875 1876 1874 1874 1872 1874 1874 1873 1873 1888 1873 1877 1873 1872 1811 1871 1873 1853 1869 1869 1869 1842 1869 1868 1868 1868 1868 1866 1868 1866 1866 1865 1865 1865 1865 1817 1865 1864 1864 1863 1864 1863 1863]
            [1879 1888 1894 1900 1902 1904 1905 1909 1909 1910 1912 1912 1913 1914 1912 1913 1912 1910 1912 1912 1909 1910 1910 1909 1908 1915 1906 1906 1905 1904 1906 1903 1906 1902 1930 1900 1902 1902 1901 1902 1900 1902 1901 1902 1898 1897 1902 1896 1894 1924 1895 1897 1895 1894 1893 1893 1891]
            [1911 1917 1924 1927 1929 1932 1936 1933 1938 1936 1975 1937 1939 1938 1938 1993 1936 1938 1936 1933 1935 1932 1930 1930 1995 1931 1928 1928 1928 1928 1928 1927 1925 1925 1925 1923 1922 1920 1967 1922 1920 1918 1917 1917 1915 1914 1913 1911 1911 1910 1912 1917 1924 1928 1928 1929 1933]
            [1951 1953 1961 1964 1968 1987 1970 1971 1966 1975 1974 1973 1953 1973 1974 1973 1971 1984 1967 1967 1971 1966 1966 1966 1964 1967 1963 1962 1962 1962 1965 1987 1959 1955 1955 1953 1953 1953 1952 1950 1941 1956 1963 1965 1967 1970 1970 1971 1974 1974 1971 1975 1974 1973 1974 1971 1971]
            [1990 1995 2001 1949 2004 2007 2008 2010 2018 2011 2012 2010 2012 2011 2009 2013 2008 2007 2007 2006 2006 2004 2004 2004 2003 2003 2000 1997 1997 1995 1996 1992 1989 2003 1995 2002 1941 2004 2007 2007 2009 2011 2013 2010 2010 2009 2010 2008 2008 2007 2006 2004 2004 2004 2003 2002 2001]
            [2021 2027 2030 2032 2035 2037 2040 2038 2038 2040 2038 2040 2038 2035 2035 2030 2035 2031 2030 2030 2030 2076 2029 2027 2027 2024 2024 2021 2019 2024 2030 2032 2034 2037 2038 2040 2040 2039 2037 2038 2035 2038 2034 2034 2034 2032 2030 2030 2029 2034 2027 2026 2026 2024 2022 2019 2019]
            [2048 2054 2055 2059 2058 2038 2062 2062 2061 2061 2061 2061 2057 2058 2068 2055 2057 2055 2054 2054 2037 2054 2052 2048 2047 2047 2054 2055 2055 2056 2058 2056 2059 2059 2058 2058 2058 2056 2056 2057 2019 2055 2055 2054 2054 2052 2053 2050 2047 2046 2047 2050 2055 2055 2051 2062 2056]
            [2068 2072 2076 2056 2081 2081 2083 2082 2082 2081 2081 2081 2080 2080 2078 2077 2149 2073 2072 2072 2070 2067 2066 2073 2077 2079 2081 2081 2082 2082 2081 2081 2081 2081 2081 2079 2078 2078 2074 2067 2073 2070 2069 2066 2065 2074 2076 2080 2081 2081 2082 2081 2082 2081 2082 2076 2080]
            [2105 2106 2107 2106 2109 2111 2110 2111 2110 2110 2109 2109 2108 2107 2107 2106 2106 2106 2104 2101 2105 2105 2106 2109 2109 2125 2110 2106 2109 2109 2108 2110 2107 2106 2106 2106 2106 2105 2104 2101 2102 2106 2106 2110 2109 2108 2110 2109 2108 2109 2106 2108 2107 2106 2105 2105 2105]
            % d = 90%
            [1851 1859 1864 1868 1872 1874 1877 1878 1880 1880 1881 1883 1881 1884 1849 1882 1895 1881 1885 1881 1882 1881 1880 1881 1881 1858 1879 1880 1881 1877 1877 1877 1877 1877 1877 1877 1885 1877 1876 1877 1875 1875 1875 1875 1876 1874 1875 1876 1873 1868 1872 1873 1871 1869 1871 1864 1871]
            [1885 1891 1900 1903 1904 1877 1908 1910 1912 1912 1912 1913 1914 1913 1914 1914 1913 1912 1912 1910 1913 1911 1911 1908 1909 1909 1908 1905 1908 1904 1906 1903 1904 1910 1902 1904 1903 1894 1902 1901 1900 1904 1900 1900 1900 1900 1897 1898 1897 1895 1895 1895 1894 1910 1893 1898 1892]
            [1914 1920 1926 1930 1929 1932 1932 1933 1938 1938 1936 1963 1937 1939 1936 1959 1934 1935 1933 1935 1933 1932 1932 1932 1929 1928 1928 1927 1928 1928 1928 1927 1925 1925 1925 1924 1924 1923 1920 1923 1919 1919 1919 1916 1916 1916 1915 1915 1914 1913 1915 1928 1928 1928 1929 1932 1932]
            [1943 1949 1953 1957 1960 1960 1962 1964 1963 1965 1963 1963 1963 1964 1965 1963 1959 1959 1959 1961 1956 1955 1955 1955 1954 1953 1953 1953 1952 1952 1951 1950 1943 1948 1977 1948 1947 1944 1942 1941 1916 1952 1953 1957 1959 1958 1963 1964 1963 1963 1964 1964 1963 1964 1963 1963 1962]
            [1966 1977 1978 1979 1982 1983 1987 1984 1984 1986 2004 1984 1983 1983 1978 1981 1982 1980 1994 1979 1979 1977 1976 1975 1979 1974 1973 1973 1971 1970 1970 1967 1961 1963 1971 1978 1979 1981 1995 1983 1985 1984 1984 1984 1992 1983 1982 1985 1982 1980 1980 1979 1981 1979 1979 1978 1977]
            [1993 2001 2003 2007 2007 2008 2010 2003 2002 2008 2008 2008 2008 2008 2004 2005 2004 2004 2030 2003 2000 2000 2000 1999 1996 1994 1994 1991 1992 1996 2003 2004 1966 2007 2009 2010 1996 2008 2009 2008 2005 2008 2006 2006 2006 2000 2004 2003 2003 2003 1999 2056 1993 1997 1995 1994 1993]
            [2017 2022 2022 2027 2025 2027 2028 2019 2030 2030 2022 2030 2029 2030 2027 2026 2026 2025 2022 2022 2021 2020 2015 2019 2017 2018 2020 2024 2090 2025 1979 2029 2022 2028 2029 2027 2028 2026 2027 2027 2025 2025 2024 2022 2025 2020 2019 2038 2018 2018 2018 2020 2022 2026 2028 2027 2027]
            [2037 2043 2043 2044 2046 2046 2047 2050 2069 2048 2046 2047 2046 2045 2045 2044 2042 2043 2042 2081 2041 2038 2043 2038 2043 2044 2044 2046 2046 2048 2046 2046 2077 2045 2045 2045 2043 2042 2042 2042 2042 2041 2038 2037 2035 2040 2042 2030 2046 2030 2046 2046 2049 2047 2045 2045 2046]
            [2058 2059 2065 2067 2068 2068 2068 2069 2068 2068 2068 2065 2064 2106 2068 2061 2057 2057 2055 2055 2056 2061 2064 2067 2068 2068 2068 2068 2066 2067 2064 2065 2108 2062 2061 2060 2057 2056 2055 2055 2055 2061 2063 2067 2067 2068 2066 2068 2067 2066 2067 2066 2065 2064 2061 2058 2070]];

CUR_MEAN = mean(CUR_MEAS,2);
% 200 is the gain of the INA241A5
% 75 * 10^(-3) is the value of the current sensing resistor
CUR_VAL = CUR_MEAN(:,1) * 10^(-3) / 200 / (75 * 10^(-3));

S_ANGLE_V = zeros(9,9);
S_TRANS_V = zeros(9,9);
S_CURRENT = zeros(9,9);
S_POWER_C = zeros(9,9);
S_ANGLE_EFF = zeros(9,9);
S_TRANS_EFF = zeros(9,9);

% looping over duty cycle
for d = 1:9
    % initialize frequency array index
    f = 1;
    
    % looping over frequency
    for freq = 10:5:50
        % read in the Vicon .csv file
        M = readtable('C:\Users\alexn\Documents\senior_thesis\actuator3\actuator3 f'+string(freq)+' d'+string(d)+'.csv', 'ReadVariableNames', false);
        numRows = height(M) + 2;
        M = readmatrix('C:\Users\alexn\Documents\senior_thesis\actuator3\actuator3 f'+string(freq)+' d'+string(d)+'.csv', 'Range', 'A6:H'+string(numRows));

        % unit processing
        M(:,2) = M(:,1) / 120;
        M(:,3) = M(:,3) * 180 / pi;
        M(:,4) = M(:,4) * 180 / pi;
        M(:,5) = M(:,5) * 180 / pi;

        % smoothing
        S = smoothdata(M,"gaussian",120); % window size of 120 to match frame/sampling rate

        % find valid initial and final indices
        firstValidIndex = find(~isnan(M(:,5)), 1);
        lastValidIndex = find(~isnan(M(:,5)), 1, 'last');

        % calculate angular velocity
        S_ANGLE_V(d,f) = (S(lastValidIndex, 5) - S(firstValidIndex, 5)) / 15;
        
        % calculate magnitude of translational velocity
        v_x = (S(lastValidIndex, 6) - S(firstValidIndex, 6)) / 15;
        v_y = (S(lastValidIndex, 7) - S(firstValidIndex, 7)) / 15;
        S_TRANS_V(d,f) = sqrt(v_x^2 + v_y^2);

        % calculate current consumption and power
        S_CURRENT(d,f) = CUR_VAL((d-1)*9 + f, 1);
        S_POWER_C(d,f) = S_CURRENT(d,f) * 7.4; % 7.4 is the total input voltage to eViper


        S_ANGLE_EFF(d,f) = abs(S_ANGLE_V(d,f)) / S_POWER_C(d,f);
        S_TRANS_EFF(d,f) = S_TRANS_V(d,f) / S_POWER_C(d,f);

        % increment frequency array indexing
        f = f + 1;
    end
end

%%
% initialize frames to measure average velocities from
init_start = 1;
init_end = 50;
final_start = 2100;
final_end = 2150;

freq = 25;
duty = 5;
M = readtable('C:\Users\alexn\Documents\senior_thesis\actuator3\actuator3 f'+string(freq)+' d'+string(duty)+'.csv', 'ReadVariableNames', false);
numRows = height(M) + 2;
M = readmatrix('C:\Users\alexn\Documents\senior_thesis\actuator3\actuator3 f'+string(freq)+' d'+string(duty)+'.csv', 'Range', 'A6:H'+string(numRows));

% unit processing
M(:,2) = M(:,1) / 120;
M(:,3) = M(:,3) * 180 / pi;
M(:,4) = M(:,4) * 180 / pi;
M(:,5) = M(:,5) * 180 / pi;

% smoothing
S = smoothdata(M,"gaussian",120); % window size of 120 to match frame/sampling rate

% unsmoothed
close all;
figure(1);
subplot(2, 2, 1);
% plot(M(:,1), M(:,3));
% hold on;
% plot(M(:,1), M(:,4));
plot(M(:,1), M(:,5));
% legend({'angular disp. in X dir. (degree)', 'angular disp. in Y dir. (degree)', 'angular disp. in Z dir. (degree)'}, 'Location', 'east');
legend({'angular pos. in degrees'});
grid minor;
grid on;
hold off;

subplot(2, 2, 3);
plot(M(:,1), M(:,6));
legend({'X pos. (mm)'});
grid minor;
grid on;
hold off;

subplot(2, 2, 4);
plot(M(:,1), M(:,7));
legend({'Y pos. (mm)'});
grid minor;
grid on;
hold off;

sgtitle('actuator 4, frequency '+string(freq)+', duty cycle '+string(duty));

% smoothed
figure(2);
subplot(2, 2, 1);
% plot(M(:,1), M(:,3));
% hold on;
% plot(M(:,1), M(:,4));
plot(S(:,1), S(:,5));
% legend({'angular disp. in X dir. (degree)', 'angular disp. in Y dir. (degree)', 'angular disp. in Z dir. (degree)'}, 'Location', 'east');
legend({'angular pos. in degrees'});
grid minor;
grid on;
hold off;

subplot(2, 2, 3);
plot(S(:,1), S(:,6));
legend({'X pos. (mm)'});
grid minor;
grid on;
hold off;

subplot(2, 2, 4);
plot(S(:,1), S(:,7));
legend({'Y pos. (mm)'});
grid minor;
grid on;
hold off;

sgtitle('smoothed actuator 4, frequency '+string(freq)+', duty cycle '+string(duty));

% smoothed
figure(3);
subplot(2, 2, 1);
% plot(M(:,1), M(:,3));
% hold on;
% plot(M(:,1), M(:,4));
plot(M(:,1), M(:,5));
hold on;
plot(S(:,1), S(:,5));
% legend({'angular disp. in X dir. (degree)', 'angular disp. in Y dir. (degree)', 'angular disp. in Z dir. (degree)'}, 'Location', 'east');
legend({'angular pos. in degrees', 'smoothed angular pos. in degrees'});
grid minor;
grid on;
hold off;

subplot(2, 2, 3);
plot(M(:,1), M(:,6));
hold on;
plot(S(:,1), S(:,6));
legend({'X pos. (mm)', 'smoothed X pos. (mm)'});
grid minor;
grid on;
hold off;

subplot(2, 2, 4);
plot(M(:,1), M(:,7));
hold on;
plot(S(:,1), S(:,7));
legend({'Y pos. (mm)', 'smoothed Y pos. (mm)'});
grid minor;
grid on;
hold off;

sgtitle('smoothed vs unsmoothed actuator 4, frequency '+string(freq)+', duty cycle '+string(duty));

firstValidIndex = find(~isnan(M(:,5)), 1);
lasValidIndex = find(~isnan(M(:,5)), 1, 'last');
%%
% calculate angular velocity
init_angle = mean(M(init_start:init_end,5), "all");
final_angle = mean(M(final_start:final_end,5), "all");
avg_angle_vel = (final_angle - init_angle) / 15;
disp("ANGLE: ");
% disp(init_angle);
% disp(final_angle);
disp(avg_angle_vel);

% calculate x velocity
init_x = mean(M(init_start:init_end,6), "all");
final_x = mean(M(final_start:final_end,6), "all");
avg_x_vel = (final_x - init_x) / 15;
disp("X: ");
% disp(init_x);
% disp(final_x);
disp(avg_x_vel);

% calculate y velocity
init_y = mean(M(init_start:init_end,7), "all");
final_y = mean(M(final_start:final_end,7), "all");
avg_y_vel = (final_y - init_y) / 15;
disp("Y: ");
% disp(init_y);
% disp(final_y);
disp(avg_y_vel);

%%

% calculate angular velocity
init_angle = mean(M(init_start:init_end,5), "all");
final_angle = mean(M(final_start:final_end,5), "all");
avg_angle_vel = (final_angle - init_angle) / 15;
disp("ANGLE: ");
% disp(init_angle);
% disp(final_angle);
disp(avg_angle_vel);

% calculate x velocity
init_x = mean(M(init_start:init_end,6), "all");
final_x = mean(M(final_start:final_end,6), "all");
avg_x_vel = (final_x - init_x) / 15;
disp("X: ");
% disp(init_x);
% disp(final_x);
disp(avg_x_vel);

% calculate y velocity
init_y = mean(M(init_start:init_end,7), "all");
final_y = mean(M(final_start:final_end,7), "all");
avg_y_vel = (final_y - init_y) / 15;
disp("Y: ");
% disp(init_y);
% disp(final_y);
disp(avg_y_vel);
